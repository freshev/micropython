/*                                                                                          
 * This file is part of the MicroPython project, http://micropython.org/
 *
 * Development of the code in this file was sponsored by Microbric Pty Ltd
 *
 * The MIT License (MIT)
 *
 * Copyright (c) 2019 pulkin
 * Copyright (c) 2024 freshev
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */

#include "luat_network_adapter.h"
#include "ps_lib_api.h"
#include "modcellular.h"
#include "modcellsms.c"

// Tracks the status on the network
uint8_t network_status = 0;
uint16_t network_exception = NTW_NO_EXC;
uint8_t network_signal_quality = 0;
int16_t network_signal_rx_level = 0;
int8_t network_signal_snr = 0;
mp_obj_t network_status_callback = mp_const_none;
mp_obj_list_t *plmn_list_buffer = NULL;

void modcellular_network_status_update(uint8_t new_status, uint16_t new_exception) {
    if (new_exception) network_exception = new_exception;
    network_status = new_status;
    if (network_status_callback && network_status_callback != mp_const_none) {
        mp_sched_schedule(network_status_callback, mp_obj_new_int(network_status));
    }
}

static void mobile_event_cb(LUAT_MOBILE_EVENT_E event, uint8_t index, uint8_t status) {
    luat_mobile_cell_info_t cell_info;
    luat_mobile_signal_strength_info_t signal_info;
    uint8_t csq, i;
    char imsi[20];
    char iccid[24] = {0};
    char apn[32] = {0};
    ip_addr_t ipv4;
    ip_addr_t ipv6;

    switch(event) {
        case LUAT_MOBILE_EVENT_CFUN:
            LUAT_DEBUG_PRINT("CFUN message, status %d", status);
            break;
        
        case LUAT_MOBILE_EVENT_SIM:
            //if (status != LUAT_MOBILE_SIM_NUMBER) {  LUAT_DEBUG_PRINT("SIM card message, card slot %d", index); }
            switch(status) {
                case LUAT_MOBILE_SIM_READY:
                    //LUAT_DEBUG_PRINT("SIM card works normally");
                    //luat_mobile_get_iccid(index, iccid, sizeof(iccid));
                    //LUAT_DEBUG_PRINT("ICCID %s", iccid);
                    //luat_mobile_get_imsi(index, imsi, sizeof(imsi));
                    //LUAT_DEBUG_PRINT("IMSI %s", imsi);
                    break;
                case LUAT_MOBILE_NO_SIM:
                    //LUAT_DEBUG_PRINT("SIM card does not exist");
                    modcellular_network_status_update(0, NTW_EXC_NOSIM);
                    break;
                case LUAT_MOBILE_SIM_NEED_PIN:
                    LUAT_DEBUG_PRINT("SIM card requires PIN code");
                    break;
                }
            break;
        case LUAT_MOBILE_EVENT_REGISTER_STATUS:
            
            switch(status) {
                case LUAT_MOBILE_STATUS_UNREGISTER:
                    LUAT_DEBUG_PRINT("Mobile status unregistered");
                    modcellular_network_status_update(0, 0);
                    break;
                case LUAT_MOBILE_STATUS_REGISTERED:
                    LUAT_DEBUG_PRINT("Mobile status registered home", status);
                    modcellular_network_status_update(NTW_REG_BIT, 0);
                    break;  
                case LUAT_MOBILE_STATUS_INSEARCH:
                    LUAT_DEBUG_PRINT("Mobile status searching");
                    modcellular_network_status_update(NTW_REG_PROGRESS_BIT, 0);
                    break;
                case LUAT_MOBILE_STATUS_DENIED:
                    LUAT_DEBUG_PRINT("Mobile status registration denied");
                    modcellular_network_status_update(0, NTW_EXC_REG_DENIED);
                    break;
                case LUAT_MOBILE_STATUS_UNKNOW:
                    LUAT_DEBUG_PRINT("Mobile status unknown");                  
                    break;
                case LUAT_MOBILE_STATUS_REGISTERED_ROAMING:
                    LUAT_DEBUG_PRINT("Mobile status registered roaming");
                    modcellular_network_status_update(NTW_REG_BIT | NTW_ROAM_BIT, 0);
                    break;
                case LUAT_MOBILE_STATUS_EMERGENCY_REGISTERED:
                    LUAT_DEBUG_PRINT("Mobile status registered emergency only");
                    break;              
                default:
                    LUAT_DEBUG_PRINT("Mobile status %d", status);
                    break;
            }
            break;

        case LUAT_MOBILE_EVENT_CELL_INFO:
            //LUAT_DEBUG_PRINT("LUAT_MOBILE_EVENT_CELL_INFO with status %d", status);
            switch(status) {                
                case LUAT_MOBILE_CELL_INFO_UPDATE:
                    //LUAT_DEBUG_PRINT("Periodic search for cell information is completed once");
                    luat_mobile_get_last_notify_cell_info(&cell_info);
                    if (cell_info.lte_service_info.cid)
                    {
                        //LUAT_DEBUG_PRINT("Service cell information mcc %x mnc %x cellid %u band %d tac %u pci %u earfcn %u is_tdd %d rsrp %d rsrq %d snr %d rssi %d",
                        //      cell_info.lte_service_info.mcc, cell_info.lte_service_info.mnc, cell_info.lte_service_info.cid,
                        //      cell_info.lte_service_info.band, cell_info.lte_service_info.tac, cell_info.lte_service_info.pci, cell_info.lte_service_info.earfcn,
                        //      cell_info.lte_service_info.is_tdd, cell_info.lte_service_info.rsrp, cell_info.lte_service_info.rsrq,
                        //      cell_info.lte_service_info.snr, cell_info.lte_service_info.rssi);
                    }
                    for (i = 0; i < cell_info.lte_neighbor_info_num; i++)
                    {
                        if (cell_info.lte_info[i].cid)
                        {
                            //LUAT_DEBUG_PRINT("Neighboring cell %d mcc %x mnc %x cellid %u tac %u pci %u", i + 1, cell_info.lte_info[i].mcc,
                            //      cell_info.lte_info[i].mnc, cell_info.lte_info[i].cid, cell_info.lte_info[i].tac, cell_info.lte_info[i].pci);
                            //LUAT_DEBUG_PRINT("Neighboring cell %d earfcn %u rsrp %d rsrq %d snr %d", i + 1, cell_info.lte_info[i].earfcn, cell_info.lte_info[i].rsrp,
                            //      cell_info.lte_info[i].rsrq, cell_info.lte_info[i].snr);
                        }
                    }
                    break;
                case LUAT_MOBILE_SIGNAL_UPDATE:
                    //LUAT_DEBUG_PRINT("Service cell signal status changes");
                    luat_mobile_get_last_notify_signal_strength_info(&signal_info);
                    luat_mobile_get_last_notify_signal_strength(&csq);
                    if (signal_info.luat_mobile_lte_signal_strength_vaild)
                    {
                        //LUAT_DEBUG_PRINT("rsrp %d, rsrq %d, snr %d, rssi %d, csq %d %d", signal_info.lte_signal_strength.rsrp,
                        //      signal_info.lte_signal_strength.rsrq, signal_info.lte_signal_strength.snr,
                        //      signal_info.lte_signal_strength.rssi, csq, luat_mobile_rssi_to_csq(signal_info.lte_signal_strength.rssi));

                        network_signal_quality = luat_mobile_rssi_to_csq(signal_info.lte_signal_strength.rssi);
                        network_signal_rx_level = signal_info.lte_signal_strength.rssi;
                        network_signal_snr = signal_info.lte_signal_strength.snr;
                    }
                
                    break;
            }
            break;

        case LUAT_MOBILE_EVENT_PDP:
            //LUAT_DEBUG_PRINT("CID %d PDP activation status changed to %d", index, status);
            // modcellular_network_status_update(network_status & ~NTW_ACT_BIT, 0); ????
            break;

        case LUAT_MOBILE_EVENT_NETIF:
            switch (status) {
                case LUAT_MOBILE_NETIF_LINK_ON: {
                    // LUAT_DEBUG_PRINT("Can access the Internet (index=%d)", index);
                    // moved to modsocket.c, important for network socket 
                    // here index is NW_ADAPTER_INDEX_LWIP_GPRS
                    // uint8_t is_ipv6;
                    // luat_socket_check_ready(index, &is_ipv6);
                    luat_mobile_get_local_ip(0, 1, &ipv4, &ipv6);
                    if (ipv4.type != 0xff) { LUAT_DEBUG_PRINT("IPV4 %s", ip4addr_ntoa(&ipv4.u_addr.ip4)); }
                    if (ipv6.type != 0xff) { LUAT_DEBUG_PRINT("IPV6 %s", ip6addr_ntoa(&ipv4.u_addr.ip6)); }
                    modcellular_network_status_update(network_status | NTW_ACT_BIT, 0);
                    break;
                default:
                    //LUAT_DEBUG_PRINT("Can't access the Internet");
                    modcellular_network_status_update(network_status & ~NTW_ACT_BIT, NTW_EXC_ACT_FAILED);
                    break;
            }
            }
            break;
        case LUAT_MOBILE_EVENT_TIME_SYNC:
            //if (status == 0) {
            //  LUAT_DEBUG_PRINT("Time synchronized");
            //} else {
            //  LUAT_DEBUG_PRINT("Time NOT synchronized");
            //}
            break;

        case LUAT_MOBILE_EVENT_CSCON:
            //LUAT_DEBUG_PRINT("LUAT_MOBILE_EVENT_CSCON with status %d", status);
            if(status == 0) {
                //LUAT_DEBUG_PRINT("RRC status detached");
                modcellular_network_status_update(network_status & ~NTW_ATT_BIT, 0);
            }
            if(status == 1) {
                //LUAT_DEBUG_PRINT("RRC status attached");
                modcellular_network_status_update(network_status | NTW_ATT_BIT, 0);
            }
            // modcellular_network_status_update(network_status & ~NTW_ATT_BIT, NTW_EXC_ATT_FAILED);
            break;

        case LUAT_MOBILE_EVENT_BEARER:
            //LUAT_DEBUG_PRINT("BEARER status %d", status);
            break;

        case LUAT_MOBILE_EVENT_NAS_ERROR:
            LUAT_DEBUG_PRINT("NAS exception type %d, rejection reason %d", index, status);
            break;

        case LUAT_MOBILE_EVENT_FATAL_ERROR:
            LUAT_DEBUG_PRINT("The network needs serious failure. It is recommended to restart the protocol stack after 5 seconds.");
            break;
        default:
            LUAT_DEBUG_PRINT("No handler: event=%d, status=%d", event, status);
            break;
    }
}


void modcellular_init0(void) {
    network_status_callback = mp_const_none;
    sms_callback = mp_const_none;
    ussd_callback = mp_const_none;

    // Reset statuses
    network_exception = NTW_NO_EXC;
    // set RRC release time to 1 sec and "idle timeout" to 55 secs
    luat_mobile_set_auto_rrc_default();    

    luat_sms_init();
    luat_sms_recv_msg_register_handler(modcellular_sms_recv_cb); 
    luat_sms_send_msg_register_handler(modcellular_sms_send_cb); 
    luat_mobile_sms_event_register_handler(sms_event_cb); // redefine SMS callback, inited in "luat_sms_init"
    luat_mobile_event_register_handler(mobile_event_cb); 
    modcellular_init_sms(); // set SMS storage to SM

    net_lwip_init();
    net_lwip_register_adapter(NW_ADAPTER_INDEX_LWIP_GPRS);
    network_register_set_default(NW_ADAPTER_INDEX_LWIP_GPRS);

    luat_mobile_set_period_work(90000, 5000, 4);
    luat_mobile_set_check_network_period(120000);
    luat_mobile_set_sim_id(2);
    luat_mobile_set_sim_detect_sim0_first();
}


// Register
// not supported, TODO receive HAL_WAKEUP_2 message 

STATIC mp_obj_t modcellular_get_signal_quality(void) {
    // ========================================
    // Retrieves the network signal quality.
    // Returns:
    //     Two integers: quality
    // ========================================
    mp_obj_t tuple[3] = {
        network_signal_quality == 31 ? mp_const_none : mp_obj_new_int(network_signal_quality),
        network_signal_rx_level == -999 ? mp_const_none : mp_obj_new_int(network_signal_rx_level),
        network_signal_snr == 0 ? mp_const_none : mp_obj_new_int(network_signal_snr)
    };
    return mp_obj_new_tuple(3, tuple);
}

STATIC MP_DEFINE_CONST_FUN_OBJ_0(modcellular_get_signal_quality_obj, modcellular_get_signal_quality);

STATIC mp_obj_t modcellular_get_imei(size_t n_args, const mp_obj_t *args) {
    // ========================================
    // Retrieves IMEI number.
    // Args:
    //     index: SIM index (0 or 1)
    // Returns:
    //     IMEI number as a string.
    // ========================================
    int index = 0;
    if(n_args == 1) index = mp_obj_get_int(args[0]);
    char imei[16];
    memset(imei,0,sizeof(imei));
    int res = luat_mobile_get_imei(index, imei, sizeof(imei));
    if (res > 0) return mp_obj_new_str(imei, strlen(imei));
    else return mp_obj_new_str("", 0);
}

STATIC MP_DEFINE_CONST_FUN_OBJ_VAR_BETWEEN(modcellular_get_imei_obj, 0, 1, modcellular_get_imei);

STATIC mp_obj_t modcellular_is_sim_present(size_t n_args, const mp_obj_t *args) {
    // ========================================
    // Checks whether the SIM card is inserted and ICCID can be retrieved.
    // Args:
    //     index: SIM index (0 or 1)
    // Returns:
    //     True if SIM present.
    // ========================================
    int index = 0;
    if(n_args == 1) index = mp_obj_get_int(args[0]);
    int res = luat_mobile_get_sim_ready(index);
    if(res == 1) return mp_obj_new_bool(true);
    else return mp_obj_new_bool(false);
}

STATIC MP_DEFINE_CONST_FUN_OBJ_VAR_BETWEEN(modcellular_is_sim_present_obj, 0, 1, modcellular_is_sim_present);


STATIC mp_obj_t modcellular_poll_network_exception(void) {
    // ========================================
    // Raises a last network exception.
    // ========================================
    uint8_t e = network_exception;
    network_exception = NTW_NO_EXC;

    switch (e) {
        case NTW_NO_EXC:
            break;
        default:
            mp_raise_OSError(e);
            break;
    }
    return mp_const_none;
}

STATIC MP_DEFINE_CONST_FUN_OBJ_0(modcellular_poll_network_exception_obj, modcellular_poll_network_exception);

STATIC mp_obj_t modcellular_get_network_status(void) {
    // ========================================
    // Retrieves the network status.
    // Returns:
    //     Network status as an integer.
    // ========================================
    return mp_obj_new_int(network_status);
}

STATIC MP_DEFINE_CONST_FUN_OBJ_0(modcellular_get_network_status_obj, modcellular_get_network_status);

STATIC mp_obj_t modcellular_is_network_registered(void) {
    // ========================================
    // Checks whether registered on the cellular network.
    // Returns:
    //     True if registered.
    // ========================================
    return mp_obj_new_bool(network_status & NTW_REG_BIT);
}

STATIC MP_DEFINE_CONST_FUN_OBJ_0(modcellular_is_network_registered_obj, modcellular_is_network_registered);

STATIC mp_obj_t modcellular_is_roaming(void) {
    // ========================================
    // Checks whether registered on the roaming network.
    // Returns:
    //     True if roaming.
    // ========================================
    REQUIRES_NETWORK_REGISTRATION; // checks network_status

    return mp_obj_new_bool(network_status & NTW_ROAM_BIT);
}

STATIC MP_DEFINE_CONST_FUN_OBJ_0(modcellular_is_roaming_obj, modcellular_is_roaming);

STATIC mp_obj_t modcellular_get_iccid(size_t n_args, const mp_obj_t *args) {
    // ========================================
    // Retrieves ICCID number.
    // Args:
    //     index: SIM index (0 or 1)
    // Returns:
    //     ICCID number as a string.
    // ========================================
    int index = 0;
    if(n_args == 1) index = mp_obj_get_int(args[0]);
    char iccid[21];
    memset(iccid, 0, sizeof(iccid));
    int res = luat_mobile_get_iccid(index, iccid, sizeof(iccid));
    if(res > 0) return mp_obj_new_str(iccid, strlen(iccid));
    else {
        mp_raise_RuntimeError("No ICCID data available");
        return mp_const_none;
    }
}

STATIC MP_DEFINE_CONST_FUN_OBJ_VAR_BETWEEN(modcellular_get_iccid_obj, 0, 1, modcellular_get_iccid);


STATIC mp_obj_t modcellular_get_imsi(size_t n_args, const mp_obj_t *args) {
    // ========================================
    // Retrieves IMSI number.
    // Args:
    //     index: SIM index (0 or 1)
    // Returns:
    //     IMSI number as a string.
    // ========================================
    int index = 0;
    if(n_args == 1) index = mp_obj_get_int(args[0]);
    char imsi[21];
    memset(imsi, 0, sizeof(imsi));
    int res = luat_mobile_get_imsi(index, imsi, sizeof(imsi));
    if(res > 0) return mp_obj_new_str(imsi, strlen(imsi));
    else {
        mp_raise_RuntimeError("No IMSI data available");
        return mp_const_none;
    }
}

STATIC MP_DEFINE_CONST_FUN_OBJ_VAR_BETWEEN(modcellular_get_imsi_obj, 0, 1, modcellular_get_imsi);

bool get_flight_mode(int index) {
    int res = luat_mobile_get_flymode(index);
    if (res < 0) mp_raise_RuntimeError("Failed to retrieve flight mode status");
    return res == 0;
}

STATIC mp_obj_t modcellular_flight_mode(size_t n_args, const mp_obj_t *args) {
    // ========================================
    // Retrieves and switches the flight mode
    // status.
    // Args:
    //      mode: flight mode (1 - on, 0 - off)
    //      index (optional): SIM index, 
    // Returns:
    //     The new flight mode status.
    // ========================================
    int index = 0;
    if (n_args > 0) {
        if (n_args == 2) index = mp_obj_get_int(args[1]);
        mp_int_t set_flag = mp_obj_get_int(args[0]);
        int res = luat_mobile_set_flymode(index, set_flag);
        if(res != 0){
            mp_raise_RuntimeError("Failed to set flight mode status");
            return mp_const_none;
        }
        WAIT_UNTIL(set_flag == get_flight_mode(index), TIMEOUT_FLIGHT_MODE, 100, mp_raise_OSError(MP_ETIMEDOUT));
    }
    return mp_obj_new_bool(get_flight_mode(index));
}

STATIC MP_DEFINE_CONST_FUN_OBJ_VAR_BETWEEN(modcellular_flight_mode_obj, 0, 2, modcellular_flight_mode);

STATIC mp_obj_t modcellular_set_bands(size_t n_args, const mp_obj_t *args) {
    // ========================================
    // Sets 4G bands the module operates at.
    // Args:
    //     bands (int): a mask specifying
    //     bands;
    // ========================================
    if (n_args == 0 || (n_args == 1 && mp_obj_get_int(args[0]) == BANDS_ALL)) {
        // uint8_t default_bands[32];
        // uint8_t default_count;
        // get all supported bands (for info only)
        // luat_mobile_get_band(default_bands, &default_count);
        // for(int i = 0; i < default_count; i++) LUAT_DEBUG_PRINT("Use band %d", default_bands[i]);
        uint8_t default_bands[] = {
            #ifdef NETWORK_FREQ_BAND_1
            1,
            #endif
            #ifdef NETWORK_FREQ_BAND_3
            3,
            #endif
            #ifdef NETWORK_FREQ_BAND_5
            5, 
            #endif
            #ifdef NETWORK_FREQ_BAND_8
            8,
            #endif
            #ifdef NETWORK_FREQ_BAND_34
            34,
            #endif
            #ifdef NETWORK_FREQ_BAND_38
            38,
            #endif
            #ifdef NETWORK_FREQ_BAND_39
            39,
            #endif
            #ifdef NETWORK_FREQ_BAND_40
            40, 
            #endif
            #ifdef NETWORK_FREQ_BAND_41
            41,
            #endif
        };
        // set all bands
        int res = luat_mobile_set_band(default_bands, sizeof(default_bands));
        if(res != 0) {
            mp_raise_RuntimeError("Failed to reset bands");
            return mp_const_none;
        }
    } else if (n_args == 1) {
        uint8_t bands[1];
        bands[0] = mp_obj_get_int(args[0]);
        int res = luat_mobile_set_band(bands, 1);
        if(res != 0) {
            mp_raise_RuntimeError("Failed to set bands");
            return mp_const_none;
        }
    }
    return mp_const_none;
}

STATIC MP_DEFINE_CONST_FUN_OBJ_VAR_BETWEEN(modcellular_set_bands_obj, 0, 1, modcellular_set_bands);


STATIC mp_obj_t modcellular_gprs(size_t n_args, const mp_obj_t *args) {
    // ========================================
    // Polls and switches GPRS status.
    // Args:
    //     apn (str, bool): access point name
    //     or False if GPRS shutdown requested.
    //     user (str): username;
    //     pass (str): password;
    //     timeout (int): time to wait until
    //     connected;
    // Returns:
    //     True if GPRS is active, False
    //     otherwise.
    // ========================================
    REQUIRES_NETWORK_REGISTRATION; // checks network_status

    if (n_args == 1 || n_args == 2) {
        mp_int_t flag = mp_obj_get_int(args[0]);
        if (flag != 0) {
            mp_raise_ValueError("Unkown integer argument supplied, zero (or False) expected");
            return mp_const_none;
        }
        // mp_int_t timeout = TIMEOUT_NETWORK_ACTIVATION;
        // if (n_args == 2) timeout = mp_obj_get_int(args[1]);
        // Do nothing
        // Perhaps deactivate RRC ?
        return mp_obj_new_bool(network_status & NTW_ACT_BIT);

    } else if (n_args == 3 || n_args == 4) {
        const char* c_apn = mp_obj_str_get_str(args[0]);
        const char* c_user = mp_obj_str_get_str(args[1]);
        const char* c_pass = mp_obj_str_get_str(args[2]);
        //mp_int_t timeout = TIMEOUT_NETWORK_ACTIVATION;
        //if (n_args == 4) timeout = mp_obj_get_int(args[3]);

        if (network_status & NTW_ACT_BIT) {
            mp_raise_ValueError("Network is already on");
            return mp_const_none;
        } else {
            mp_raise_RuntimeError("Should never happens");
        }
    } else if (n_args != 0) {
        mp_raise_ValueError("Unexpected number of argument: 0, 1 or 3 required");
    }

    return mp_obj_new_bool(network_status & NTW_ACT_BIT);
}

STATIC MP_DEFINE_CONST_FUN_OBJ_VAR_BETWEEN(modcellular_gprs_obj, 0, 4, modcellular_gprs);



void modcellular_clear_scan_list() {
    mp_obj_list_t *self = MP_OBJ_TO_PTR(plmn_list_buffer);
    if(self != NULL) {
        self->len = 0;
        self->items = m_renew(mp_obj_t, self->items, self->alloc, LIST_MIN_ALLOC);
        self->alloc = LIST_MIN_ALLOC;
        mp_seq_clear(self->items, 0, self->alloc, sizeof(*self->items));
    }
}

static void modcellular_get_operator_name(uint8_t plmn[PLMN_STR_MAX_LENGTH], char *pOperatorName);
STATIC mp_obj_t modcellular_scan(void) {
    // ========================================
    // Lists network operators.
    // ========================================

    mp_obj_t plmn_list = mp_obj_new_list(0, NULL);
    if(plmn_list_buffer == NULL) plmn_list_buffer = mp_obj_new_list(0, NULL);
    else modcellular_clear_scan_list();

    if(plmn_list_buffer != NULL) {

        ManualPlmnSearchInfo * pManualPlmnSearchInfo = LUAT_MEM_MALLOC(sizeof(ManualPlmnSearchInfo));
        if(pManualPlmnSearchInfo != NULL) {
            memset(pManualPlmnSearchInfo, 0, sizeof(ManualPlmnSearchInfo));
            pManualPlmnSearchInfo->plmnNum = CMI_MM_PLMN_SEARCH_NUM;
            CmsRetId ret = appManualPlmnSearch(TIMEOUT_LIST_OPERATORS / 1000, pManualPlmnSearchInfo);
        
            if (ret == CMS_RET_SUCC) {            
                for (int i = 0; i < pManualPlmnSearchInfo->plmnNum; i++) {
                    /*
                    UINT8  plmn[PLMN_STR_MAX_LENGTH];
                    UINT8  plmnState;   //CmiMmPlmnStateEnum, cops <stat>
                    UINT8  longPlmn[CMI_MM_STR_PLMN_MAX_LENGTH]; // end with '\0' // 32 chars
                    UINT8  shortPlmn[CMI_MM_SHORT_STR_PLMN_MAX_LENGTH]; // end with '\0'
                    UINT8  act; //CmiCregActEnum, cops <act>
                    typedef enum CmiCregActEnum_Tag {
                        CMI_MM_GSM = 0,
                        CMI_MM_GSM_COMPACT = 1,
                        CMI_MM_UMTS = 2,
                        CMI_MM_GSM_EGPRS = 3,
                        CMI_MM_HSDPA = 4,
                        CMI_MM_HSUPA = 5,
                        CMI_MM_HSDPA_HSUPA = 6,
                        CMI_MM_LTE = 7,
                        CMI_MM_EC_GSM = 8,
                        CMI_NB_IOT = 9 //NB only
                    }CmiCregActEnum; 
                    */
                    PlmnSearchInfo plmn = pManualPlmnSearchInfo->plmnList[i];
                    //LUAT_DEBUG_PRINT("PLMN: plmn=%s, plmnState=%d, longPlmn=%s, shortPlmn=%s, act=%d", plmn.plmn, plmn.plmnState, plmn.longPlmn, plmn.shortPlmn, plmn.act);
        
                    modcellular_get_operator_name(plmn.plmn, (char*)plmn.longPlmn);
                    if(strlen((char*)plmn.longPlmn) != 0) {
                        //LUAT_DEBUG_PRINT("Operator=%s", (char*)plmn.longPlmn);
                        mp_obj_t tuple[3] = {
                            mp_obj_new_str((char*)plmn.plmn, strlen((char*)plmn.plmn)),
                            mp_obj_new_str((char*)plmn.longPlmn, strlen((char*)plmn.longPlmn)),
                            mp_obj_new_int(plmn.plmnState),
                        };
                        mp_obj_list_append(plmn_list, mp_obj_new_tuple(3, tuple));                                    
                    }
                }
            }
            LUAT_MEM_FREE(pManualPlmnSearchInfo);
        }
        modcellular_clear_scan_list();
    }
    return plmn_list;
}

STATIC MP_DEFINE_CONST_FUN_OBJ_0(modcellular_scan_obj, modcellular_scan);


STATIC int modcellular_convert_MCCMNC(int code) {
    // convert to hex and use as int
    char str [10];
    itoa(code, str, 16);
    return atoi(str);
}

STATIC mp_obj_t modcellular_stations(void) {
    // ========================================
    // Returns base stations cells.
    // ========================================
    luat_mobile_cell_info_t info = {0};
    if (luat_mobile_get_cell_info(&info) != 0) {
        mp_raise_RuntimeError("Failed to poll base stations");
        return mp_const_none;
    }

    mp_obj_t cell_list = mp_obj_new_list(0, NULL);

    if (info.lte_info_valid) {
        luat_mobile_lte_service_cell_info_t cell = info.lte_service_info;
        mp_obj_t tuple[8] = {
            mp_obj_new_int(modcellular_convert_MCCMNC(cell.mcc)),
            mp_obj_new_int(modcellular_convert_MCCMNC(cell.mnc)),
            mp_obj_new_int(cell.tac),
            mp_obj_new_int(cell.cid),
            mp_obj_new_int(cell.pci),
            mp_obj_new_int(cell.rsrq),
            mp_obj_new_int(cell.snr),
            mp_obj_new_int(cell.earfcn),
        };
        mp_obj_list_append(cell_list, mp_obj_new_tuple(8, tuple));

        for (int i = 0; i < info.lte_neighbor_info_num; i++) {
            luat_mobile_lte_cell_info_t ncell = info.lte_info[i];
            mp_obj_t tuple[8] = {
                mp_obj_new_int(modcellular_convert_MCCMNC(ncell.mcc)),
                mp_obj_new_int(modcellular_convert_MCCMNC(ncell.mnc)),
                mp_obj_new_int(ncell.tac),
                mp_obj_new_int(ncell.cid),
                mp_obj_new_int(ncell.pci),
                mp_obj_new_int(ncell.rsrq),
                mp_obj_new_int(ncell.snr),
                mp_obj_new_int(ncell.earfcn),
            };
            //LUAT_DEBUG_PRINT("neighbour cell[%d]: mcc=%d, mnc=%d, tac=%d, cid=%d, rsrq=%d, snr=%d, earfcn=%d", i, ncell.mcc, ncell.mnc, ncell.tac, ncell.cid, ncell.rsrq, ncell.snr, ncell.earfcn);
            mp_obj_list_append(cell_list, mp_obj_new_tuple(8, tuple));
        }
    }
    return cell_list;
    
}

STATIC MP_DEFINE_CONST_FUN_OBJ_0(modcellular_stations_obj, modcellular_stations);

STATIC mp_obj_t modcellular_reset(void) {
    // ========================================
    // Resets network settings to defaults.
    // Note:
    //     Conflicts with setting flight mode. 
    //     Only one can be used within a certain period of time.
    // ========================================    
    luat_mobile_reset_stack();
    modcellular_init0();
    return mp_const_none;
}

STATIC MP_DEFINE_CONST_FUN_OBJ_0(modcellular_reset_obj, modcellular_reset);

STATIC mp_obj_t modcellular_on_status_event(mp_obj_t callable) {
    // ========================================
    // Sets a callback on status event.
    // Args:
    //     callback (Callable): a callback to
    //     execute on status event.
    // ========================================
    network_status_callback = callable;
    return mp_const_none;
}

STATIC MP_DEFINE_CONST_FUN_OBJ_1(modcellular_on_status_event_obj, modcellular_on_status_event);


STATIC const mp_map_elem_t mp_module_cellular_globals_table[] = {
    { MP_OBJ_NEW_QSTR(MP_QSTR___name__), MP_OBJ_NEW_QSTR(MP_QSTR_cellular) },

    { MP_OBJ_NEW_QSTR(MP_QSTR_SMS), (mp_obj_t)MP_ROM_PTR(&modcellular_sms_type) },

    { MP_OBJ_NEW_QSTR(MP_QSTR_get_imei), (mp_obj_t)&modcellular_get_imei_obj },
    { MP_OBJ_NEW_QSTR(MP_QSTR_get_signal_quality), (mp_obj_t)&modcellular_get_signal_quality_obj },
    { MP_OBJ_NEW_QSTR(MP_QSTR_poll_network_exception), (mp_obj_t)&modcellular_poll_network_exception_obj },
    
    { MP_OBJ_NEW_QSTR(MP_QSTR_get_network_status), (mp_obj_t)&modcellular_get_network_status_obj },
    { MP_OBJ_NEW_QSTR(MP_QSTR_is_sim_present), (mp_obj_t)&modcellular_is_sim_present_obj },
    { MP_OBJ_NEW_QSTR(MP_QSTR_is_network_registered), (mp_obj_t)&modcellular_is_network_registered_obj },
    { MP_OBJ_NEW_QSTR(MP_QSTR_is_roaming), (mp_obj_t)&modcellular_is_roaming_obj },
    { MP_OBJ_NEW_QSTR(MP_QSTR_get_iccid), (mp_obj_t)&modcellular_get_iccid_obj },
    { MP_OBJ_NEW_QSTR(MP_QSTR_get_imsi), (mp_obj_t)&modcellular_get_imsi_obj },
    { MP_OBJ_NEW_QSTR(MP_QSTR_flight_mode), (mp_obj_t)&modcellular_flight_mode_obj },
    { MP_OBJ_NEW_QSTR(MP_QSTR_set_bands), (mp_obj_t)&modcellular_set_bands_obj },
    { MP_OBJ_NEW_QSTR(MP_QSTR_gprs), (mp_obj_t)&modcellular_gprs_obj },
    { MP_OBJ_NEW_QSTR(MP_QSTR_scan), (mp_obj_t)&modcellular_scan_obj },
    { MP_OBJ_NEW_QSTR(MP_QSTR_ussd), (mp_obj_t)&modcellular_ussd_obj },
    { MP_OBJ_NEW_QSTR(MP_QSTR_stations), (mp_obj_t)&modcellular_stations_obj },
    { MP_OBJ_NEW_QSTR(MP_QSTR_reset), (mp_obj_t)&modcellular_reset_obj },
    { MP_OBJ_NEW_QSTR(MP_QSTR_on_status_event), (mp_obj_t)&modcellular_on_status_event_obj },
    { MP_OBJ_NEW_QSTR(MP_QSTR_on_sms), (mp_obj_t)&modcellular_on_sms_obj },
    { MP_OBJ_NEW_QSTR(MP_QSTR_on_ussd), (mp_obj_t)&modcellular_on_ussd_obj },

    #ifdef NETWORK_FREQ_BAND_1
    { MP_ROM_QSTR(MP_QSTR_NETWORK_FREQ_BAND_1),  MP_ROM_INT(1)  },
    #endif
    #ifdef NETWORK_FREQ_BAND_3
    { MP_ROM_QSTR(MP_QSTR_NETWORK_FREQ_BAND_3),  MP_ROM_INT(3)  },
    #endif
    #ifdef NETWORK_FREQ_BAND_5
    { MP_ROM_QSTR(MP_QSTR_NETWORK_FREQ_BAND_5),  MP_ROM_INT(5)  },
    #endif
    #ifdef NETWORK_FREQ_BAND_8
    { MP_ROM_QSTR(MP_QSTR_NETWORK_FREQ_BAND_8),  MP_ROM_INT(8)  },
    #endif
    #ifdef NETWORK_FREQ_BAND_34
    { MP_ROM_QSTR(MP_QSTR_NETWORK_FREQ_BAND_34), MP_ROM_INT(34) },
    #endif
    #ifdef NETWORK_FREQ_BAND_38
    { MP_ROM_QSTR(MP_QSTR_NETWORK_FREQ_BAND_38), MP_ROM_INT(38) },
    #endif
    #ifdef NETWORK_FREQ_BAND_39
    { MP_ROM_QSTR(MP_QSTR_NETWORK_FREQ_BAND_39), MP_ROM_INT(39) },
    #endif
    #ifdef NETWORK_FREQ_BAND_40
    { MP_ROM_QSTR(MP_QSTR_NETWORK_FREQ_BAND_40), MP_ROM_INT(40) },
    #endif
    #ifdef NETWORK_FREQ_BAND_41
    { MP_ROM_QSTR(MP_QSTR_NETWORK_FREQ_BAND_41), MP_ROM_INT(41) },
    #endif
    { MP_ROM_QSTR(MP_QSTR_NETWORK_FREQ_BANDS_ALL), MP_ROM_INT(BANDS_ALL) },

    { MP_ROM_QSTR(MP_QSTR_OPERATOR_STATUS_UNKNOWN), MP_ROM_INT(0) },
    { MP_ROM_QSTR(MP_QSTR_OPERATOR_STATUS_AVAILABLE), MP_ROM_INT(1) },
    { MP_ROM_QSTR(MP_QSTR_OPERATOR_STATUS_CURRENT), MP_ROM_INT(2) },
    { MP_ROM_QSTR(MP_QSTR_OPERATOR_STATUS_DISABLED), MP_ROM_INT(3) },

    { MP_ROM_QSTR(MP_QSTR_ENOSIM), MP_ROM_INT(NTW_EXC_NOSIM) },
    { MP_ROM_QSTR(MP_QSTR_EREGD), MP_ROM_INT(NTW_EXC_REG_DENIED) },
    { MP_ROM_QSTR(MP_QSTR_ESMSSEND), MP_ROM_INT(NTW_EXC_SMS_SEND) },
    { MP_ROM_QSTR(MP_QSTR_ESMSDROP), MP_ROM_INT(NTW_EXC_SMS_DROP) },
    //{ MP_ROM_QSTR(MP_QSTR_ESIMDROP), MP_ROM_INT(NTW_EXC_SIM_DROP) },
    //{ MP_ROM_QSTR(MP_QSTR_EATTACHMENT), MP_ROM_INT(NTW_EXC_ATT_FAILED) },
    { MP_ROM_QSTR(MP_QSTR_EACTIVATION), MP_ROM_INT(NTW_EXC_ACT_FAILED) },

    { MP_OBJ_NEW_QSTR(MP_QSTR_sms_delete_by_index), (mp_obj_t)&modcellular_sms_delete_by_index_obj },
    { MP_OBJ_NEW_QSTR(MP_QSTR_sms_delete_all_read), (mp_obj_t)&modcellular_sms_delete_all_read_obj },
    { MP_OBJ_NEW_QSTR(MP_QSTR_sms_read_all), (mp_obj_t)&modcellular_sms_read_all_obj },
    { MP_OBJ_NEW_QSTR(MP_QSTR_sms_list_read), (mp_obj_t)&modcellular_sms_list_read_obj },
    { MP_OBJ_NEW_QSTR(MP_QSTR_sms_list), (mp_obj_t)&modcellular_sms_list_obj },
    { MP_OBJ_NEW_QSTR(MP_QSTR_sms_get_storage_size), (mp_obj_t)&modcellular_sms_get_storage_size_obj },
    
};

STATIC MP_DEFINE_CONST_DICT(mp_module_cellular_globals, mp_module_cellular_globals_table);

const mp_obj_module_t cellular_module = {
    .base = { &mp_type_module },
    .globals = (mp_obj_dict_t*)&mp_module_cellular_globals,
};

MP_REGISTER_MODULE(MP_QSTR_cellular, cellular_module);


typedef struct _OPER_INFO
{
    uint8_t OperatorId[6];
    const char *OperatorName;
} OPER_INFO;

static OPER_INFO _OperatorInfo[] =
{
{{0x02,0x00,0x02,0x00,0x01,0x0f},"COSMOTEGR"},{{0x02,0x00,0x02,0x00,0x05,0x0f},"vodafoneGR"},{{0x02,0x00,0x02,0x01,0x00,0x0f},"WINDGR"},{{0x02,0x00,0x04,0x00,0x04,0x0f},"VodafoneNL"},
{{0x02,0x00,0x04,0x00,0x08,0x0f},"KPNNL"},{{0x02,0x00,0x04,0x01,0x02,0x0f},"TelfortNL"},{{0x02,0x00,0x04,0x01,0x06,0x0f},"T-MobileNL"},{{0x02,0x00,0x04,0x02,0x00,0x0f},"OrangeNL"},
{{0x02,0x00,0x06,0x00,0x01,0x0f},"Proximus"},{{0x02,0x00,0x06,0x01,0x00,0x0f},"Mobistar"},{{0x02,0x00,0x06,0x02,0x00,0x0f},"BASE"},{{0x02,0x00,0x08,0x00,0x01,0x0f},"OrangeF"},
{{0x02,0x00,0x08,0x01,0x00,0x0f},"SFRFR"},{{0x02,0x00,0x08,0x02,0x00,0x0f},"BouyguesFR"},{{0x02,0x01,0x03,0x00,0x03,0x0f},"MOBILAND"},{{0x02,0x01,0x04,0x00,0x01,0x0f},"vodafoneES"},
{{0x02,0x01,0x04,0x00,0x03,0x0f},"Orange"},{{0x02,0x01,0x04,0x00,0x04,0x0f},"Yoigo"},{{0x02,0x01,0x04,0x00,0x07,0x0f},"movistar"},{{0x02,0x01,0x06,0x00,0x01,0x0f},"Hpannon"},
{{0x02,0x01,0x06,0x03,0x00,0x0f},"T-MobileH"},{{0x02,0x01,0x06,0x07,0x00,0x0f},"vodafoneHU"},{{0x02,0x01,0x08,0x00,0x03,0x0f},"Eronet"},{{0x02,0x01,0x08,0x00,0x05,0x0f},"m:tel"},
{{0x02,0x01,0x08,0x09,0x00,0x0f},"BHMobile"},{{0x02,0x01,0x09,0x00,0x01,0x0f},"T-Mobile"},{{0x02,0x01,0x09,0x00,0x02,0x0f},"Tele2"},{{0x02,0x01,0x09,0x01,0x00,0x0f},"VIPnet"},
{{0x02,0x02,0x00,0x00,0x01,0x0f},"Telenor"},{{0x02,0x02,0x00,0x00,0x02,0x0f},"ProMonte"},{{0x02,0x02,0x00,0x00,0x03,0x0f},"mt:s"},{{0x02,0x02,0x00,0x00,0x04,0x0f},"T-MobileCG"},
{{0x02,0x02,0x00,0x00,0x05,0x0f},"VIPMobile"},{{0x02,0x02,0x02,0x00,0x01,0x0f},"TIMIT"},{{0x02,0x02,0x02,0x01,0x00,0x0f},"vodafoneIT"},{{0x02,0x02,0x02,0x08,0x08,0x0f},"WINDIT"},
{{0x02,0x02,0x02,0x09,0x09,0x0f},"3IT"},{{0x02,0x02,0x06,0x00,0x01,0x0f},"ROVodafone"},{{0x02,0x02,0x06,0x00,0x03,0x0f},"ROCOSMOTE"},{{0x02,0x02,0x06,0x00,0x05,0x0f},"RODigiMobil"},
{{0x02,0x02,0x06,0x01,0x00,0x0f},"ROORANGE"},{{0x02,0x02,0x08,0x00,0x01,0x0f},"Swisscom"},{{0x02,0x02,0x08,0x00,0x02,0x0f},"Sunrise"},{{0x02,0x02,0x08,0x00,0x03,0x0f},"ORANGE"},
{{0x02,0x02,0x08,0x00,0x07,0x0f},"In&Phone"},{{0x02,0x02,0x08,0x00,0x08,0x0f},"Tele2"},{{0x02,0x03,0x00,0x00,0x01,0x0f},"T-MobileCZ"},{{0x02,0x03,0x00,0x00,0x02,0x0f},"O2CZ"},
{{0x02,0x03,0x00,0x00,0x03,0x0f},"VodafoneCZ"},{{0x02,0x03,0x01,0x00,0x01,0x0f},"OrangeSK"},{{0x02,0x03,0x01,0x00,0x02,0x0f},"T-MobileSK"},{{0x02,0x03,0x01,0x00,0x06,0x0f},"O2SK"},
{{0x02,0x03,0x02,0x00,0x01,0x0f},"A1"},{{0x02,0x03,0x02,0x00,0x03,0x0f},"T-MobileA"},{{0x02,0x03,0x02,0x00,0x05,0x0f},"OrangeAT"},{{0x02,0x03,0x02,0x00,0x07,0x0f},"telering"},
{{0x02,0x03,0x02,0x01,0x00,0x0f},"3AT"},{{0x02,0x03,0x02,0x01,0x02,0x0f},"OrangeAT"},{{0x02,0x03,0x04,0x00,0x01,0x0f},"UK01"},{{0x02,0x03,0x04,0x01,0x00,0x0f},"O2UK"},
{{0x02,0x03,0x04,0x01,0x05,0x0f},"VodafoneUK"},{{0x02,0x03,0x04,0x02,0x00,0x0f},"3UK"},{{0x02,0x03,0x04,0x03,0x00,0x0f},"T-MobileUK"},{{0x02,0x03,0x04,0x03,0x01,0x0f},"T-MobileUK"},
{{0x02,0x03,0x04,0x03,0x02,0x0f},"T-MobileUK"},{{0x02,0x03,0x04,0x03,0x03,0x0f},"OrangeUK"},{{0x02,0x03,0x08,0x00,0x01,0x0f},"TDCMOBIL"},{{0x02,0x03,0x08,0x00,0x02,0x0f},"Sonofon"},
{{0x02,0x03,0x08,0x00,0x06,0x0f},"3DK"},{{0x02,0x03,0x08,0x02,0x00,0x0f},"TELIADK"},{{0x02,0x03,0x08,0x07,0x07,0x0f},"Sonofon"},{{0x02,0x04,0x00,0x00,0x01,0x0f},"TELIASE"},
{{0x02,0x04,0x00,0x00,0x02,0x0f},"3SE"},{{0x02,0x04,0x00,0x00,0x04,0x0f},"Sweden"},{{0x02,0x04,0x00,0x00,0x05,0x0f},"Sweden3G"},{{0x02,0x04,0x00,0x00,0x07,0x0f},"COMVIQSE"},
{{0x02,0x04,0x00,0x00,0x08,0x0f},"TelenorSE"},{{0x02,0x04,0x00,0x01,0x00,0x0f},"SpringMobilSE"},{{0x02,0x04,0x02,0x00,0x01,0x0f},"NTelenor"},{{0x02,0x04,0x02,0x00,0x02,0x0f},"NNetCom"},
{{0x02,0x04,0x02,0x00,0x03,0x0f},"MTU"},{{0x02,0x04,0x02,0x00,0x05,0x0f},"MobileNorway"},{{0x02,0x04,0x04,0x00,0x03,0x0f},"DNA"},{{0x02,0x04,0x04,0x00,0x05,0x0f},"FIElisa"},
{{0x02,0x04,0x04,0x01,0x02,0x0f},"DNA"},{{0x02,0x04,0x04,0x01,0x04,0x0f},"FIAMT"},{{0x02,0x04,0x04,0x09,0x01,0x0f},"FISONERA"},{{0x02,0x04,0x06,0x00,0x01,0x0f},"OMNITELLT"},
{{0x02,0x04,0x06,0x00,0x02,0x0f},"LTBITEGSM"},{{0x02,0x04,0x06,0x00,0x03,0x0f},"TELE2"},{{0x02,0x04,0x07,0x00,0x01,0x0f},"LMTLV"},{{0x02,0x04,0x07,0x00,0x02,0x0f},"TELE2LV"},
{{0x02,0x04,0x07,0x00,0x05,0x0f},"BITELV"},{{0x02,0x04,0x08,0x00,0x01,0x0f},"EEEMT"},{{0x02,0x04,0x08,0x00,0x02,0x0f},"EEelisa"},{{0x02,0x04,0x08,0x00,0x03,0x0f},"TELE2"},
{{0x02,0x05,0x00,0x00,0x01,0x0f},"MTS"},{{0x02,0x05,0x00,0x00,0x02,0x0f},"MegaFon"},{{0x02,0x05,0x00,0x00,0x04,0x0f},"SCNRUS"},{{0x02,0x05,0x00,0x00,0x05,0x0f},"STCRUS"},
{{0x02,0x05,0x00,0x00,0x07,0x0f},"SMARTS"},{{0x02,0x05,0x00,0x01,0x00,0x0f},"DTCRUS"},{{0x02,0x05,0x00,0x01,0x01,0x0f},"Yota"},{{0x02,0x05,0x00,0x01,0x02,0x0f},"AKOSRUS"},
{{0x02,0x05,0x00,0x01,0x03,0x0f},"KubanRUS"},{{0x02,0x05,0x00,0x01,0x05,0x0f},"SMARTSRUS"},{{0x02,0x05,0x00,0x01,0x06,0x0f},"NTCRUS"},{{0x02,0x05,0x00,0x01,0x07,0x0f},"UtelRUS"},
{{0x02,0x05,0x00,0x01,0x09,0x0f},"INDIGORUS"},{{0x02,0x05,0x00,0x02,0x00,0x0f},"TELE2RUS"},{{0x02,0x05,0x00,0x02,0x08,0x0f},"BeelineRUS"},{{0x02,0x05,0x00,0x03,0x05,0x0f},"MOTIVRUS"},
{{0x02,0x05,0x00,0x03,0x09,0x0f},"UtelRUS"},{{0x02,0x05,0x00,0x09,0x09,0x0f},"Beeline"},{{0x02,0x05,0x05,0x00,0x01,0x0f},"UMC"},{{0x02,0x05,0x05,0x00,0x02,0x0f},"Beeline"},
{{0x02,0x05,0x05,0x00,0x03,0x0f},"Kyivstar"},{{0x02,0x05,0x05,0x00,0x05,0x0f},"Uni"},{{0x02,0x05,0x05,0x00,0x06,0x0f},"life:)"},{{0x02,0x05,0x05,0x00,0x07,0x0f},"Utel"},
{{0x02,0x05,0x07,0x00,0x01,0x0f},"Velcom"},{{0x02,0x05,0x07,0x00,0x02,0x0f},"MTS"},{{0x02,0x05,0x07,0x00,0x03,0x0f},"Diallog"},{{0x02,0x05,0x07,0x00,0x04,0x0f},"Best"},
{{0x02,0x05,0x09,0x00,0x01,0x0f},"OrangeMD"},{{0x02,0x05,0x09,0x00,0x02,0x0f},"MOLDCELLMD"},{{0x02,0x05,0x09,0x00,0x04,0x0f},"EVENTISMD"},{{0x02,0x06,0x00,0x00,0x01,0x0f},"Plus"},
{{0x02,0x06,0x00,0x00,0x02,0x0f},"Era"},{{0x02,0x06,0x00,0x00,0x03,0x0f},"OrangePL"},{{0x02,0x06,0x00,0x00,0x06,0x0f},"Play"},{{0x02,0x06,0x02,0x00,0x01,0x0f},"T-MobileD"},
{{0x02,0x06,0x02,0x00,0x02,0x0f},"Vodafone.de"},{{0x02,0x06,0x02,0x00,0x03,0x0f},"E-Plus"},{{0x02,0x06,0x02,0x00,0x07,0x0f},"O2-de"},{{0x02,0x06,0x02,0x00,0x08,0x0f},"O2-de"},
{{0x02,0x06,0x06,0x00,0x01,0x0f},"GIBTEL"},{{0x02,0x06,0x08,0x00,0x01,0x0f},"vodafoneP"},{{0x02,0x06,0x08,0x00,0x03,0x0f},"OptimusP"},{{0x02,0x06,0x08,0x00,0x06,0x0f},"TMNP"},
{{0x02,0x07,0x00,0x00,0x01,0x0f},"LLUXGSM"},{{0x02,0x07,0x00,0x07,0x07,0x0f},"LTANGO"},{{0x02,0x07,0x00,0x09,0x09,0x0f},"LVOX"},{{0x02,0x07,0x02,0x00,0x01,0x0f},"vodafoneIRL"},
{{0x02,0x07,0x02,0x00,0x02,0x0f},"O2IRL"},{{0x02,0x07,0x02,0x00,0x03,0x0f},"METEORIRL"},{{0x02,0x07,0x02,0x00,0x05,0x0f},"3IRL"},{{0x02,0x07,0x04,0x00,0x01,0x0f},"Siminn"},
{{0x02,0x07,0x04,0x00,0x02,0x0f},"Vodafone"},{{0x02,0x07,0x04,0x00,0x04,0x0f},"Viking"},{{0x02,0x07,0x04,0x00,0x07,0x0f},"IceCell"},{{0x02,0x07,0x04,0x00,0x08,0x0f},"On-waves"},
{{0x02,0x07,0x04,0x01,0x01,0x0f},"NOVA"},{{0x02,0x07,0x06,0x00,0x01,0x0f},"AMC-AL"},{{0x02,0x07,0x06,0x00,0x02,0x0f},"vodafoneAL"},{{0x02,0x07,0x06,0x00,0x03,0x0f},"EAGLEAL"},
{{0x02,0x07,0x08,0x00,0x01,0x0f},"vodafoneMT"},{{0x02,0x07,0x08,0x02,0x01,0x0f},"gomobile"},{{0x02,0x07,0x08,0x07,0x07,0x0f},"3GTMT"},{{0x02,0x08,0x00,0x00,0x01,0x0f},"CYTAVODA"},
{{0x02,0x08,0x00,0x01,0x00,0x0f},"Areeba"},{{0x02,0x08,0x02,0x00,0x01,0x0f},"GCELL"},{{0x02,0x08,0x02,0x00,0x02,0x0f},"MAGTI"},{{0x02,0x08,0x02,0x00,0x04,0x0f},"BEELINE"},
{{0x02,0x08,0x03,0x00,0x01,0x0f},"BeelineAM"},{{0x02,0x08,0x03,0x00,0x05,0x0f},"ARMMTS"},{{0x02,0x08,0x04,0x00,0x01,0x0f},"M-TelBG"},{{0x02,0x08,0x04,0x00,0x03,0x0f},"vivatel"},
{{0x02,0x08,0x04,0x00,0x05,0x0f},"BGGLOBUL"},{{0x02,0x08,0x06,0x00,0x01,0x0f},"Turkcell"},{{0x02,0x08,0x06,0x00,0x02,0x0f},"VODAFONETR"},{{0x02,0x08,0x06,0x00,0x03,0x0f},"AVEA"},
{{0x02,0x08,0x08,0x00,0x01,0x0f},"F?royaTele"},{{0x02,0x08,0x08,0x00,0x02,0x0f},"KALL"},{{0x02,0x09,0x00,0x00,0x01,0x0f},"TELEGRL"},{{0x02,0x09,0x03,0x04,0x00,0x0f},"Si.mobil"},
{{0x02,0x09,0x03,0x04,0x01,0x0f},"Mobitel"},{{0x02,0x09,0x03,0x06,0x04,0x0f},"T-2"},{{0x02,0x09,0x03,0x07,0x00,0x0f},"Tu?mobil"},{{0x02,0x09,0x04,0x00,0x01,0x0f},"T-MobileMK"},
{{0x02,0x09,0x04,0x00,0x02,0x0f},"COSMOFONMKD"},{{0x02,0x09,0x04,0x00,0x03,0x0f},"VipMKD"},{{0x02,0x09,0x05,0x00,0x01,0x0f},"SwisscomFL"},{{0x02,0x09,0x05,0x00,0x02,0x0f},"OrangeFL"},
{{0x02,0x09,0x05,0x00,0x05,0x0f},"FL1"},{{0x02,0x09,0x05,0x07,0x07,0x0f},"LITANGO"},{{0x03,0x00,0x02,0x03,0x05,0x00},"FIRST"},{{0x03,0x00,0x02,0x03,0x07,0x00},"Fido"},
{{0x03,0x00,0x02,0x03,0x08,0x00},"DMTS"},{{0x03,0x00,0x02,0x07,0x02,0x00},"ROGERS"},{{0x03,0x00,0x08,0x00,0x01,0x0f},"AMERIS"},{{0x03,0x01,0x00,0x00,0x01,0x00},"MCI"},
{{0x03,0x01,0x00,0x00,0x01,0x02},"Verizon Wireless"},{{0x03,0x01,0x00,0x00,0x01,0x03},"Mobile Tel Inc."},{{0x03,0x01,0x00,0x00,0x01,0x04},"Testing"},{{0x03,0x01,0x00,0x00,0x01,0x06},"Cricket Communications"},
{{0x03,0x01,0x00,0x00,0x01,0x07},"North Sight Communications"},{{0x03,0x01,0x00,0x00,0x02,0x00},"Union Telephone Company"},{{0x03,0x01,0x00,0x00,0x03,0x00},"Centennial Communications"},{{0x03,0x01,0x00,0x00,0x03,0x00},"Centennial"},
{{0x03,0x01,0x00,0x00,0x03,0x02},"IT&E Overseas, Inc."},{{0x03,0x01,0x00,0x00,0x03,0x03},"Guam Telephone Authority"},{{0x03,0x01,0x00,0x00,0x03,0x04},"Nevada Wireless LLC"},{{0x03,0x01,0x00,0x01,0x03,0x00},"CellOne"},
{{0x03,0x01,0x00,0x01,0x05,0x00},"AT&T"},{{0x03,0x01,0x00,0x01,0x06,0x00},"T-Mobile"},{{0x03,0x01,0x00,0x01,0x07,0x00},"AT&T"},{{0x03,0x01,0x00,0x02,0x00,0x00},"T-Mobile"},
{{0x03,0x01,0x00,0x02,0x01,0x00},"T-Mobile"},{{0x03,0x01,0x00,0x02,0x02,0x00},"T-Mobile"},{{0x03,0x01,0x00,0x02,0x03,0x00},"T-Mobile"},{{0x03,0x01,0x00,0x02,0x04,0x00},"T-Mobile"},
{{0x03,0x01,0x00,0x02,0x05,0x00},"T-Mobile"},{{0x03,0x01,0x00,0x02,0x06,0x00},"T-Mobile"},{{0x03,0x01,0x00,0x02,0x06,0x0f},"T-Mobile"},{{0x03,0x01,0x00,0x02,0x07,0x00},"T-Mobile"},
{{0x03,0x01,0x00,0x03,0x01,0x0f},"T-Mobile"},{{0x03,0x01,0x00,0x03,0x08,0x00},"AT&T"},{{0x03,0x01,0x00,0x04,0x01,0x00},"AT&T"},{{0x03,0x01,0x00,0x06,0x06,0x00},"T-Mobile"},
{{0x03,0x01,0x00,0x08,0x09,0x00},"UNICEL"},{{0x03,0x03,0x04,0x00,0x02,0x00},"TELCEL"},{{0x03,0x03,0x04,0x00,0x03,0x00},"movistar"},{{0x03,0x03,0x04,0x00,0x03,0x0f},"movistar"},
{{0x03,0x03,0x04,0x00,0x05,0x00},"Iusacell"},{{0x03,0x03,0x08,0x00,0x05,0x00},"Digicel"},{{0x03,0x03,0x08,0x01,0x08,0x00},"bmobile"},{{0x03,0x04,0x00,0x00,0x01,0x0f},"F-Orange"},
{{0x03,0x04,0x00,0x00,0x02,0x0f},"ONLY"},{{0x03,0x04,0x00,0x02,0x00,0x0f},"DIGICEL"},{{0x03,0x04,0x04,0x00,0x03,0x00},"APUA"},{{0x03,0x04,0x04,0x09,0x02,0x00},"bMobile"},
{{0x03,0x04,0x04,0x09,0x03,0x00},"Digicel"},{{0x03,0x05,0x00,0x00,0x01,0x0f},"Digicel"},{{0x03,0x05,0x00,0x00,0x02,0x0f},"M3"},{{0x03,0x05,0x02,0x00,0x03,0x00},"Digicel"},
{{0x03,0x05,0x02,0x01,0x01,0x00},"bmobile"},{{0x03,0x05,0x06,0x01,0x01,0x00},"bmobile"},{{0x03,0x05,0x08,0x01,0x01,0x00},"bmobile"},{{0x03,0x06,0x00,0x01,0x01,0x00},"bmobile"},
{{0x03,0x06,0x02,0x05,0x01,0x0f},"TELCELLGSM"},{{0x03,0x06,0x02,0x06,0x09,0x0f},"CTGSM"},{{0x03,0x06,0x02,0x09,0x05,0x01},"ANT"},{{0x03,0x06,0x03,0x00,0x01,0x0f},"SETARGSM"},
{{0x03,0x06,0x08,0x00,0x01,0x0f},"Cubacel"},{{0x03,0x07,0x00,0x00,0x01,0x0f},"orange"},{{0x03,0x07,0x00,0x00,0x02,0x0f},"CLARODOM"},{{0x03,0x07,0x02,0x00,0x01,0x0f},"COMCEL"},
{{0x03,0x07,0x04,0x01,0x02,0x0f},"bmobile"},{{0x04,0x00,0x00,0x00,0x01,0x0f},"AZEACELL"},{{0x04,0x00,0x00,0x00,0x02,0x0f},"AZEBKCELL"},{{0x04,0x00,0x00,0x00,0x04,0x0f},"Nar"},
{{0x04,0x00,0x01,0x00,0x01,0x0f},"BeelineKZ"},{{0x04,0x00,0x01,0x00,0x02,0x0f},"KCELLKZ"},{{0x04,0x00,0x01,0x07,0x07,0x0f},"NEOKZ"},{{0x04,0x00,0x02,0x01,0x01,0x0f},"B-Mobile"},
{{0x04,0x00,0x02,0x07,0x07,0x0f},"TashiCell"},{{0x04,0x00,0x04,0x00,0x00,0x0f},"SISTEMASHYAM"},{{0x04,0x00,0x04,0x00,0x01,0x0f},"Vodafone"},{{0x04,0x00,0x04,0x00,0x02,0x0f},"Airtel"},
{{0x04,0x00,0x04,0x00,0x03,0x00},"Vodafone"},{{0x04,0x00,0x04,0x00,0x03,0x0f},"Airtel"},{{0x04,0x00,0x04,0x00,0x04,0x0f},"IDEA"},{{0x04,0x00,0x04,0x00,0x05,0x0f},"Vodafone"},
{{0x04,0x00,0x04,0x00,0x06,0x0f},"Airtel"},{{0x04,0x00,0x04,0x00,0x07,0x0f},"IDEA"},{{0x04,0x00,0x04,0x00,0x09,0x0f},"Reliance"},{{0x04,0x00,0x04,0x01,0x00,0x0f},"Airtel"},
{{0x04,0x00,0x04,0x01,0x01,0x0f},"Vodafone"},{{0x04,0x00,0x04,0x01,0x02,0x0f},"IDEA"},{{0x04,0x00,0x04,0x01,0x03,0x0f},"Vodafone"},{{0x04,0x00,0x04,0x01,0x04,0x0f},"IDEA"},
{{0x04,0x00,0x04,0x01,0x05,0x0f},"Vodafone"},{{0x04,0x00,0x04,0x01,0x06,0x0f},"Airtel"},{{0x04,0x00,0x04,0x01,0x07,0x0f},"Aircel"},{{0x04,0x00,0x04,0x01,0x08,0x0f},"Reliance"},
{{0x04,0x00,0x04,0x01,0x09,0x0f},"IDEA"},{{0x04,0x00,0x04,0x02,0x00,0x0f},"Vodafone"},{{0x04,0x00,0x04,0x02,0x01,0x0f},"LoopMobile"},{{0x04,0x00,0x04,0x02,0x02,0x0f},"IDEA"},
{{0x04,0x00,0x04,0x02,0x04,0x0f},"IDEA"},{{0x04,0x00,0x04,0x02,0x05,0x0f},"Aircel"},{{0x04,0x00,0x04,0x02,0x07,0x0f},"Vodafone"},{{0x04,0x00,0x04,0x02,0x08,0x0f},"Aircel"},
{{0x04,0x00,0x04,0x02,0x09,0x0f},"Aircel"},{{0x04,0x00,0x04,0x03,0x00,0x0f},"Vodafone"},{{0x04,0x00,0x04,0x03,0x01,0x0f},"AirTel"},{{0x04,0x00,0x04,0x03,0x03,0x0f},"Aircel"},
{{0x04,0x00,0x04,0x03,0x04,0x0f},"CellOne"},{{0x04,0x00,0x04,0x03,0x05,0x0f},"Aircel"},{{0x04,0x00,0x04,0x03,0x06,0x0f},"Reliance"},{{0x04,0x00,0x04,0x03,0x07,0x0f},"Aircel"},
{{0x04,0x00,0x04,0x03,0x08,0x0f},"CellOne"},{{0x04,0x00,0x04,0x04,0x00,0x0f},"Airtel"},{{0x04,0x00,0x04,0x04,0x01,0x0f},"Aircel"},{{0x04,0x00,0x04,0x04,0x02,0x0f},"Aircel"},
{{0x04,0x00,0x04,0x04,0x03,0x0f},"Vodafone"},{{0x04,0x00,0x04,0x04,0x04,0x0f},"IDEA"},{{0x04,0x00,0x04,0x04,0x05,0x0f},"Airtel"},{{0x04,0x00,0x04,0x04,0x06,0x0f},"Vodafone"},
{{0x04,0x00,0x04,0x04,0x09,0x0f},"AirTel"},{{0x04,0x00,0x04,0x05,0x00,0x0f},"Reliance"},{{0x04,0x00,0x04,0x05,0x01,0x0f},"CellOne"},{{0x04,0x00,0x04,0x05,0x02,0x0f},"Reliance"},
{{0x04,0x00,0x04,0x05,0x03,0x0f},"CellOne"},{{0x04,0x00,0x04,0x05,0x04,0x0f},"CellOne"},{{0x04,0x00,0x04,0x05,0x05,0x0f},"CellOne"},{{0x04,0x00,0x04,0x05,0x06,0x0f},"IDEA"},
{{0x04,0x00,0x04,0x05,0x07,0x0f},"CellOne"},{{0x04,0x00,0x04,0x05,0x08,0x0f},"CellOne"},{{0x04,0x00,0x04,0x05,0x09,0x0f},"CellOne"},{{0x04,0x00,0x04,0x06,0x00,0x0f},"Vodafone"},
{{0x04,0x00,0x04,0x06,0x02,0x0f},"CellOne"},{{0x04,0x00,0x04,0x06,0x04,0x0f},"CellOne"},{{0x04,0x00,0x04,0x06,0x06,0x0f},"CellOne"},{{0x04,0x00,0x04,0x06,0x07,0x0f},"Reliance"},
{{0x04,0x00,0x04,0x06,0x08,0x0f},"Dolphin"},{{0x04,0x00,0x04,0x06,0x09,0x0f},"Dolphin"},{{0x04,0x00,0x04,0x07,0x00,0x0f},"Airtel"},{{0x04,0x00,0x04,0x07,0x01,0x0f},"CellOne"},
{{0x04,0x00,0x04,0x07,0x02,0x0f},"CellOne"},{{0x04,0x00,0x04,0x07,0x03,0x0f},"CellOne"},{{0x04,0x00,0x04,0x07,0x04,0x0f},"CellOne"},{{0x04,0x00,0x04,0x07,0x05,0x0f},"CellOne"},
{{0x04,0x00,0x04,0x07,0x06,0x0f},"CellOne"},{{0x04,0x00,0x04,0x07,0x07,0x0f},"CellOne"},{{0x04,0x00,0x04,0x07,0x08,0x0f},"IDEA"},{{0x04,0x00,0x04,0x07,0x09,0x0f},"CellOne"},
{{0x04,0x00,0x04,0x08,0x00,0x0f},"CellOne"},{{0x04,0x00,0x04,0x08,0x01,0x0f},"CellOne"},{{0x04,0x00,0x04,0x08,0x02,0x0f},"IDEA"},{{0x04,0x00,0x04,0x08,0x03,0x0f},"Reliance"},
{{0x04,0x00,0x04,0x08,0x04,0x0f},"Vodafone"},{{0x04,0x00,0x04,0x08,0x05,0x0f},"Reliance"},{{0x04,0x00,0x04,0x08,0x06,0x0f},"Vodafone IN"},{{0x04,0x00,0x04,0x08,0x07,0x0f},"IDEA"},
{{0x04,0x00,0x04,0x08,0x08,0x0f},"Vodafone"},{{0x04,0x00,0x04,0x08,0x09,0x0f},"IDEA"},{{0x04,0x00,0x04,0x09,0x00,0x0f},"AirTel"},{{0x04,0x00,0x04,0x09,0x01,0x0f},"Aircel"},
{{0x04,0x00,0x04,0x09,0x02,0x0f},"Airtel"},{{0x04,0x00,0x04,0x09,0x03,0x0f},"Airtel"},{{0x04,0x00,0x04,0x09,0x04,0x0f},"Airtel"},{{0x04,0x00,0x04,0x09,0x05,0x0f},"Airtel"},
{{0x04,0x00,0x04,0x09,0x06,0x0f},"Airtel"},{{0x04,0x00,0x04,0x09,0x07,0x0f},"Airtel"},{{0x04,0x00,0x04,0x09,0x08,0x0f},"Airtel"},{{0x04,0x00,0x05,0x00,0x01,0x0f},"Reliance"},
{{0x04,0x00,0x05,0x00,0x02,0x05},"TATA DOCOMO"},{{0x04,0x00,0x05,0x00,0x02,0x06},"TATA DOCOMO"},{{0x04,0x00,0x05,0x00,0x02,0x07},"TATA DOCOMO"},{{0x04,0x00,0x05,0x00,0x02,0x08},"TATA DOCOMO"},
{{0x04,0x00,0x05,0x00,0x02,0x09},"TATA DOCOMO"},{{0x04,0x00,0x05,0x00,0x03,0x00},"TATA DOCOMO"},{{0x04,0x00,0x05,0x00,0x03,0x01},"TATA DOCOMO"},{{0x04,0x00,0x05,0x00,0x03,0x02},"TATA DOCOMO"},
{{0x04,0x00,0x05,0x00,0x03,0x03},"TATA DOCOMO"},{{0x04,0x00,0x05,0x00,0x03,0x04},"TATA DOCOMO"},{{0x04,0x00,0x05,0x00,0x03,0x05},"TATA DOCOMO"},{{0x04,0x00,0x05,0x00,0x03,0x06},"TATA DOCOMO"},
{{0x04,0x00,0x05,0x00,0x03,0x07},"TATA DOCOMO"},{{0x04,0x00,0x05,0x00,0x03,0x08},"TATA DOCOMO"},{{0x04,0x00,0x05,0x00,0x03,0x09},"TATA DOCOMO"},{{0x04,0x00,0x05,0x00,0x03,0x0f},"Reliance"},
{{0x04,0x00,0x05,0x00,0x04,0x00},"TATA DOCOMO"},{{0x04,0x00,0x05,0x00,0x04,0x01},"TATA DOCOMO"},{{0x04,0x00,0x05,0x00,0x04,0x02},"TATA DOCOMO"},{{0x04,0x00,0x05,0x00,0x04,0x03},"TATA DOCOMO"},
{{0x04,0x00,0x05,0x00,0x04,0x04},"TATA DOCOMO"},{{0x04,0x00,0x05,0x00,0x04,0x05},"TATA DOCOMO"},{{0x04,0x00,0x05,0x00,0x04,0x06},"TATA DOCOMO"},{{0x04,0x00,0x05,0x00,0x04,0x07},"TATA DOCOMO"},
{{0x04,0x00,0x05,0x00,0x04,0x0f},"Reliance"},{{0x04,0x00,0x05,0x00,0x05,0x0f},"Reliance"},{{0x04,0x00,0x05,0x00,0x06,0x0f},"Reliance"},{{0x04,0x00,0x05,0x00,0x07,0x0f},"Reliance"},
{{0x04,0x00,0x05,0x00,0x08,0x0f},"Reliance"},{{0x04,0x00,0x05,0x00,0x09,0x0f},"Reliance"},{{0x04,0x00,0x05,0x01,0x00,0x0f},"Reliance"},{{0x04,0x00,0x05,0x01,0x01,0x0f},"Reliance"},
{{0x04,0x00,0x05,0x01,0x02,0x0f},"Reliance"},{{0x04,0x00,0x05,0x01,0x03,0x0f},"Reliance"},{{0x04,0x00,0x05,0x01,0x04,0x0f},"Reliance"},{{0x04,0x00,0x05,0x01,0x05,0x01},"Airtel"},
{{0x04,0x00,0x05,0x01,0x05,0x03},"Airtel"},{{0x04,0x00,0x05,0x01,0x05,0x0f},"Reliance"},{{0x04,0x00,0x05,0x01,0x07,0x0f},"Reliance"},{{0x04,0x00,0x05,0x01,0x08,0x0f},"Reliance"},
{{0x04,0x00,0x05,0x01,0x09,0x0f},"Reliance"},{{0x04,0x00,0x05,0x02,0x00,0x0f},"Reliance"},{{0x04,0x00,0x05,0x02,0x01,0x0f},"Reliance"},{{0x04,0x00,0x05,0x02,0x02,0x0f},"Reliance"},
{{0x04,0x00,0x05,0x02,0x03,0x0f},"Reliance"},{{0x04,0x00,0x05,0x02,0x04,0x0f},"Reliance"},{{0x04,0x00,0x05,0x04,0x08,0x0f},"Indian Railways"},{{0x04,0x00,0x05,0x05,0x01,0x0f},"AirTel"},
{{0x04,0x00,0x05,0x05,0x02,0x0f},"AirTel"},{{0x04,0x00,0x05,0x05,0x03,0x0f},"AirTel"},{{0x04,0x00,0x05,0x05,0x04,0x0f},"AirTel"},{{0x04,0x00,0x05,0x05,0x05,0x0f},"AirTel"},
{{0x04,0x00,0x05,0x05,0x06,0x0f},"AirTel"},{{0x04,0x00,0x05,0x06,0x06,0x0f},"Vodafone"},{{0x04,0x00,0x05,0x06,0x07,0x0f},"Vodafone"},{{0x04,0x00,0x05,0x07,0x00,0x0f},"IDEA"},
{{0x04,0x00,0x05,0x07,0x05,0x00},"Vodafone"},{{0x04,0x00,0x05,0x07,0x05,0x01},"Vodafone"},{{0x04,0x00,0x05,0x07,0x05,0x02},"Vodafone"},{{0x04,0x00,0x05,0x07,0x05,0x03},"Vodafone"},
{{0x04,0x00,0x05,0x07,0x05,0x04},"Vodafone"},{{0x04,0x00,0x05,0x07,0x05,0x05},"Vodafone"},{{0x04,0x00,0x05,0x07,0x05,0x06},"Vodafone"},{{0x04,0x00,0x05,0x07,0x09,0x09},"IDEA"},
{{0x04,0x00,0x05,0x08,0x00,0x00},"Aircel"},{{0x04,0x00,0x05,0x08,0x00,0x01},"Aircel"},{{0x04,0x00,0x05,0x08,0x00,0x02},"Aircel"},{{0x04,0x00,0x05,0x08,0x00,0x03},"Karnataka"},
{{0x04,0x00,0x05,0x08,0x00,0x04},"Aircel"},{{0x04,0x00,0x05,0x08,0x00,0x05},"Aircel"},{{0x04,0x00,0x05,0x08,0x00,0x06},"Aircel"},{{0x04,0x00,0x05,0x08,0x00,0x07},"Aircel"},
{{0x04,0x00,0x05,0x08,0x00,0x08},"Aircel"},{{0x04,0x00,0x05,0x08,0x00,0x09},"Aircel"},{{0x04,0x00,0x05,0x08,0x00,0x0f},"EtisalatDB"},{{0x04,0x00,0x05,0x08,0x01,0x00},"Aircel"},
{{0x04,0x00,0x05,0x08,0x01,0x01},"Aircel"},{{0x04,0x00,0x05,0x08,0x01,0x02},"Aircel"},{{0x04,0x00,0x05,0x08,0x01,0x03},"uninor"},{{0x04,0x00,0x05,0x08,0x01,0x04},"uninor"},
{{0x04,0x00,0x05,0x08,0x01,0x05},"uninor"},{{0x04,0x00,0x05,0x08,0x01,0x06},"uninor"},{{0x04,0x00,0x05,0x08,0x01,0x07},"uninor"},{{0x04,0x00,0x05,0x08,0x01,0x08},"uninor"},
{{0x04,0x00,0x05,0x08,0x01,0x09},"uninor"},{{0x04,0x00,0x05,0x08,0x01,0x0f},"UniNor"},{{0x04,0x00,0x05,0x08,0x02,0x00},"uninor"},{{0x04,0x00,0x05,0x08,0x02,0x01},"uninor"},
{{0x04,0x00,0x05,0x08,0x02,0x02},"uninor"},{{0x04,0x00,0x05,0x08,0x02,0x03},"Videocon"},{{0x04,0x00,0x05,0x08,0x02,0x04},"Videocon"},{{0x04,0x00,0x05,0x08,0x02,0x05},"Videocon"},
{{0x04,0x00,0x05,0x08,0x02,0x06},"Videocon"},{{0x04,0x00,0x05,0x08,0x02,0x07},"Videocon"},{{0x04,0x00,0x05,0x08,0x02,0x08},"Videocon"},{{0x04,0x00,0x05,0x08,0x02,0x09},"Videocon"},
{{0x04,0x00,0x05,0x08,0x03,0x00},"Videocon"},{{0x04,0x00,0x05,0x08,0x03,0x01},"Videocon"},{{0x04,0x00,0x05,0x08,0x03,0x02},"Videocon"},{{0x04,0x00,0x05,0x08,0x03,0x03},"Videocon"},
{{0x04,0x00,0x05,0x08,0x03,0x04},"Videocon"},{{0x04,0x00,0x05,0x08,0x03,0x05},"Videocon"},{{0x04,0x00,0x05,0x08,0x03,0x06},"Videocon"},{{0x04,0x00,0x05,0x08,0x03,0x07},"Videocon"},
{{0x04,0x00,0x05,0x08,0x03,0x08},"Videocon"},{{0x04,0x00,0x05,0x08,0x03,0x09},"Videocon"},{{0x04,0x00,0x05,0x08,0x04,0x00},"Videocon"},{{0x04,0x00,0x05,0x08,0x04,0x01},"Videocon"},
{{0x04,0x00,0x05,0x08,0x04,0x02},"Videocon"},{{0x04,0x00,0x05,0x08,0x04,0x03},"Videocon"},{{0x04,0x00,0x05,0x08,0x04,0x04},"Uninor"},{{0x04,0x00,0x05,0x08,0x04,0x05},"IDEA"},
{{0x04,0x00,0x05,0x08,0x04,0x06},"IDEA"},{{0x04,0x00,0x05,0x08,0x04,0x07},"IDEA"},{{0x04,0x00,0x05,0x08,0x04,0x08},"IDEA"},{{0x04,0x00,0x05,0x08,0x04,0x09},"IDEA"},
{{0x04,0x00,0x05,0x08,0x05,0x00},"IDEA"},{{0x04,0x00,0x05,0x08,0x05,0x01},"IDEA"},{{0x04,0x00,0x05,0x08,0x05,0x02},"IDEA"},{{0x04,0x00,0x05,0x08,0x05,0x03},"IDEA"},
{{0x04,0x00,0x05,0x08,0x05,0x04},"LoopMobile"},{{0x04,0x00,0x05,0x08,0x05,0x05},"LoopMobile"},{{0x04,0x00,0x05,0x08,0x05,0x06},"LoopMobile"},{{0x04,0x00,0x05,0x08,0x05,0x07},"LoopMobile"},
{{0x04,0x00,0x05,0x08,0x05,0x08},"LoopMobile"},{{0x04,0x00,0x05,0x08,0x05,0x09},"LoopMobile"},{{0x04,0x00,0x05,0x08,0x05,0x0f},"IDEA"},{{0x04,0x00,0x05,0x08,0x06,0x00},"LoopMobile"},
{{0x04,0x00,0x05,0x08,0x06,0x01},"LoopMobile"},{{0x04,0x00,0x05,0x08,0x06,0x02},"LoopMobile"},{{0x04,0x00,0x05,0x08,0x06,0x03},"LoopMobile"},{{0x04,0x00,0x05,0x08,0x06,0x04},"LoopMobile"},
{{0x04,0x00,0x05,0x08,0x06,0x05},"LoopMobile"},{{0x04,0x00,0x05,0x08,0x06,0x06},"LoopMobile"},{{0x04,0x00,0x05,0x08,0x06,0x07},"LoopMobile"},{{0x04,0x00,0x05,0x08,0x06,0x08},"LoopMobile"},
{{0x04,0x00,0x05,0x08,0x06,0x09},"LoopMobile"},{{0x04,0x00,0x05,0x08,0x07,0x00},"LoopMobile"},{{0x04,0x00,0x05,0x08,0x07,0x01},"LoopMobile"},{{0x04,0x00,0x05,0x08,0x07,0x02},"LoopMobile"},
{{0x04,0x00,0x05,0x08,0x07,0x03},"LoopMobile"},{{0x04,0x00,0x05,0x08,0x07,0x04},"LoopMobile"},{{0x04,0x00,0x05,0x08,0x07,0x05},"uninor"},{{0x04,0x00,0x05,0x08,0x07,0x06},"uninor"},
{{0x04,0x00,0x05,0x08,0x07,0x07},"uninor"},{{0x04,0x00,0x05,0x08,0x07,0x08},"uninor"},{{0x04,0x00,0x05,0x08,0x07,0x09},"uninor"},{{0x04,0x00,0x05,0x08,0x08,0x00},"uninor"},
{{0x04,0x00,0x05,0x08,0x08,0x01},"STEL"},{{0x04,0x00,0x05,0x08,0x08,0x02},"STEL"},{{0x04,0x00,0x05,0x08,0x08,0x03},"STEL"},{{0x04,0x00,0x05,0x08,0x08,0x04},"STEL"},
{{0x04,0x00,0x05,0x08,0x08,0x05},"STEL"},{{0x04,0x00,0x05,0x08,0x08,0x06},"STEL"},{{0x04,0x00,0x05,0x08,0x08,0x07},"SISTEMASHYAM"},{{0x04,0x00,0x05,0x08,0x08,0x08},"SISTEMASHYAM"},
{{0x04,0x00,0x05,0x08,0x08,0x09},"SISTEMASHYAM"},{{0x04,0x00,0x05,0x08,0x09,0x00},"SISTEMASHYAM"},{{0x04,0x00,0x05,0x08,0x09,0x01},"SISTEMASHYAM"},{{0x04,0x00,0x05,0x08,0x09,0x02},"SISTEMASHYAM"},
{{0x04,0x00,0x05,0x08,0x09,0x03},"SISTEMASHYAM"},{{0x04,0x00,0x05,0x08,0x09,0x04},"SISTEMASHYAM"},{{0x04,0x00,0x05,0x08,0x09,0x05},"SISTEMASHYAM"},{{0x04,0x00,0x05,0x08,0x09,0x06},"SISTEMASHYAM"},
{{0x04,0x00,0x05,0x08,0x09,0x07},"SISTEMASHYAM"},{{0x04,0x00,0x05,0x08,0x09,0x08},"SISTEMASHYAM"},{{0x04,0x00,0x05,0x08,0x09,0x09},"SISTEMASHYAM"},{{0x04,0x00,0x05,0x09,0x00,0x00},"SISTEMASHYAM"},
{{0x04,0x00,0x05,0x09,0x00,0x01},"SISTEMASHYAM"},{{0x04,0x00,0x05,0x09,0x00,0x02},"SISTEMASHYAM"},{{0x04,0x00,0x05,0x09,0x00,0x03},"SISTEMASHYAM"},{{0x04,0x00,0x05,0x09,0x00,0x04},"SISTEMASHYAM"},
{{0x04,0x00,0x05,0x09,0x00,0x05},"SISTEMASHYAM"},{{0x04,0x00,0x05,0x09,0x00,0x06},"SISTEMASHYAM"},{{0x04,0x00,0x05,0x09,0x00,0x07},"SISTEMASHYAM"},{{0x04,0x00,0x05,0x09,0x00,0x08},"SPICE"},
{{0x04,0x00,0x05,0x09,0x00,0x09},"SPICE"},{{0x04,0x00,0x05,0x09,0x01,0x00},"SPICE"},{{0x04,0x00,0x05,0x09,0x01,0x01},"ETISALAT"},{{0x04,0x00,0x05,0x09,0x01,0x02},"Cheers"},
{{0x04,0x00,0x05,0x09,0x01,0x03},"Cheers"},{{0x04,0x00,0x05,0x09,0x01,0x04},"Cheers"},{{0x04,0x00,0x05,0x09,0x01,0x05},"Cheers"},{{0x04,0x00,0x05,0x09,0x01,0x06},"Cheers"},
{{0x04,0x00,0x05,0x09,0x01,0x07},"Cheers"},{{0x04,0x00,0x05,0x09,0x01,0x08},"Cheers"},{{0x04,0x00,0x05,0x09,0x01,0x09},"Cheers"},{{0x04,0x00,0x05,0x09,0x02,0x00},"Cheers"},
{{0x04,0x00,0x05,0x09,0x02,0x01},"Cheers"},{{0x04,0x00,0x05,0x09,0x02,0x02},"Cheers"},{{0x04,0x00,0x05,0x09,0x02,0x03},"Cheers"},{{0x04,0x00,0x05,0x09,0x02,0x04},"Cheers"},
{{0x04,0x00,0x05,0x09,0x02,0x05},"uninor"},{{0x04,0x00,0x05,0x09,0x02,0x06},"uninor"},{{0x04,0x00,0x05,0x09,0x02,0x07},"uninor"},{{0x04,0x00,0x05,0x09,0x02,0x08},"uninor"},
{{0x04,0x00,0x05,0x09,0x02,0x09},"uninor"},{{0x04,0x00,0x05,0x09,0x03,0x00},"EtisalatDB"},{{0x04,0x00,0x05,0x09,0x03,0x01},"EtisalatDB"},{{0x04,0x00,0x05,0x09,0x03,0x02},"Videocon"},
{{0x04,0x01,0x00,0x00,0x01,0x0f},"Mobilink"},{{0x04,0x01,0x00,0x00,0x03,0x0f},"PK-UFONE"},{{0x04,0x01,0x00,0x00,0x04,0x0f},"ZONG"},{{0x04,0x01,0x00,0x00,0x06,0x0f},"TelenorPK"},
{{0x04,0x01,0x00,0x00,0x07,0x0f},"WaridTel"},{{0x04,0x01,0x02,0x00,0x01,0x0f},"AWCC"},{{0x04,0x01,0x02,0x02,0x00,0x0f},"Roshan"},{{0x04,0x01,0x02,0x04,0x00,0x0f},"Areeba"},
{{0x04,0x01,0x02,0x05,0x00,0x0f},"EtisalatAf"},{{0x04,0x01,0x03,0x00,0x01,0x0f},"Mobitel"},{{0x04,0x01,0x03,0x00,0x02,0x0f},"SRIDIALOG"},{{0x04,0x01,0x03,0x00,0x03,0x0f},"SRI-Tigo"},
{{0x04,0x01,0x03,0x00,0x05,0x0f},"SIRAIRTEL"},{{0x04,0x01,0x03,0x00,0x08,0x0f},"Hutch"},{{0x04,0x01,0x04,0x00,0x01,0x0f},"MPT"},{{0x04,0x01,0x05,0x00,0x01,0x0f},"Alfa"},
{{0x04,0x01,0x06,0x00,0x01,0x0f},"zainJO"},{{0x04,0x01,0x06,0x00,0x03,0x0f},"Umniah"},{{0x04,0x01,0x06,0x07,0x07,0x0f},"OrangeJO"},{{0x04,0x01,0x07,0x00,0x01,0x0f},"SyriaTel"},
{{0x04,0x01,0x07,0x00,0x02,0x0f},"Areeba"},{{0x04,0x01,0x08,0x00,0x05,0x0f},"ASIACELL"},{{0x04,0x01,0x08,0x02,0x00,0x0f},"zainIQ"},{{0x04,0x01,0x09,0x00,0x02,0x0f},"zainKW"},
{{0x04,0x01,0x09,0x00,0x03,0x0f},"Wataniya"},{{0x04,0x02,0x00,0x00,0x01,0x0f},"STC"},{{0x04,0x02,0x00,0x00,0x03,0x0f},"mobily"},{{0x04,0x02,0x01,0x00,0x01,0x0f},"SabaFon"},
{{0x04,0x02,0x01,0x00,0x02,0x0f},"MTN"},{{0x04,0x02,0x02,0x00,0x02,0x0f},"OMANMOBILE"},{{0x04,0x02,0x02,0x00,0x03,0x0f},"nawras"},{{0x04,0x02,0x04,0x00,0x02,0x0f},"ETISALAT"},
{{0x04,0x02,0x04,0x00,0x03,0x0f},"du"},{{0x04,0x02,0x05,0x00,0x01,0x0f},"Orange"},{{0x04,0x02,0x05,0x00,0x02,0x0f},"Cellcom"},{{0x04,0x02,0x05,0x00,0x03,0x0f},"Pelephone"},
{{0x04,0x02,0x05,0x00,0x05,0x0f},"Orange"},{{0x04,0x02,0x06,0x00,0x01,0x0f},"BATELCO"},{{0x04,0x02,0x06,0x00,0x02,0x0f},"zainBH"},{{0x04,0x02,0x07,0x00,0x01,0x0f},"Qat-Qtel"},
{{0x04,0x02,0x08,0x08,0x08,0x0f},"Unitel"},{{0x04,0x02,0x08,0x09,0x09,0x0f},"MobiCom"},{{0x04,0x02,0x09,0x00,0x01,0x0f},"NTC"},{{0x04,0x02,0x09,0x00,0x02,0x0f},"MeroMobile"},
{{0x04,0x03,0x02,0x01,0x01,0x0f},"MCI"},{{0x04,0x03,0x02,0x01,0x04,0x0f},"KISH"},{{0x04,0x03,0x02,0x01,0x09,0x0f},"MTCE"},{{0x04,0x03,0x02,0x03,0x02,0x0f},"Taliya"},
{{0x04,0x03,0x02,0x03,0x05,0x0f},"IranCell"},{{0x04,0x03,0x04,0x00,0x01,0x0f},"Buztel"},{{0x04,0x03,0x04,0x00,0x02,0x0f},"Uzmacom"},{{0x04,0x03,0x04,0x00,0x04,0x0f},"BeelineUZ"},
{{0x04,0x03,0x04,0x00,0x05,0x0f},"UZBUcell"},{{0x04,0x03,0x04,0x00,0x06,0x0f},"Perfectum"},{{0x04,0x03,0x04,0x00,0x07,0x0f},"UZBMTS"},{{0x04,0x03,0x06,0x00,0x01,0x0f},"Somoncom"},
{{0x04,0x03,0x06,0x00,0x02,0x0f},"INDIGO-T"},{{0x04,0x03,0x06,0x00,0x03,0x0f},"MLT"},{{0x04,0x03,0x06,0x00,0x04,0x0f},"Babilon"},{{0x04,0x03,0x06,0x00,0x05,0x0f},"BEELINE"},
{{0x04,0x03,0x06,0x01,0x02,0x0f},"INDIGO-T"},{{0x04,0x03,0x07,0x00,0x01,0x0f},"BITEL"},{{0x04,0x03,0x07,0x00,0x05,0x0f},"MEGACOM"},{{0x04,0x03,0x08,0x00,0x01,0x0f},"MTSTM"},
{{0x04,0x04,0x00,0x00,0x00,0x0f},"eMobile"},{{0x04,0x04,0x00,0x01,0x00,0x0f},"NTTDoCoMo"},{{0x04,0x04,0x00,0x02,0x00,0x0f},"Softbank"},{{0x04,0x05,0x00,0x00,0x02,0x0f},"KTF"},
{{0x04,0x05,0x00,0x00,0x05,0x0f},"SKTelecom"},{{0x04,0x05,0x00,0x00,0x08,0x0f},"KTF"},{{0x04,0x05,0x02,0x00,0x01,0x0f},"Mobifone"},{{0x04,0x05,0x02,0x00,0x02,0x0f},"VINAPHONE"},
{{0x04,0x05,0x02,0x00,0x04,0x0f},"Viettel"},{{0x04,0x05,0x02,0x00,0x05,0x0f},"VietnamobileVN"},{{0x04,0x05,0x02,0x00,0x07,0x0f},"BeelineVN"},{{0x04,0x05,0x04,0x00,0x00,0x0f},"CSL"},
{{0x04,0x05,0x04,0x00,0x02,0x0f},"CSL"},{{0x04,0x05,0x04,0x00,0x03,0x0f},"3HK"},{{0x04,0x05,0x04,0x00,0x04,0x0f},"3HK"},{{0x04,0x05,0x04,0x00,0x06,0x0f},"SmarToneVodafone"},
{{0x04,0x05,0x04,0x01,0x00,0x0f},"NewWorld"},{{0x04,0x05,0x04,0x01,0x02,0x0f},"CMCC"},{{0x04,0x05,0x04,0x01,0x05,0x0f},"SmarToneVodafone"},{{0x04,0x05,0x04,0x01,0x06,0x0f},"PCCW"},
{{0x04,0x05,0x04,0x01,0x08,0x0f},"CSL"},{{0x04,0x05,0x04,0x01,0x09,0x0f},"PCCW"},{{0x04,0x05,0x05,0x00,0x00,0x0f},"SmarToneVodafone"},{{0x04,0x05,0x05,0x00,0x01,0x0f},"CTM"},
{{0x04,0x05,0x05,0x00,0x03,0x0f},"3Macau"},{{0x04,0x05,0x05,0x00,0x04,0x0f},"CTM"},{{0x04,0x05,0x05,0x00,0x05,0x0f},"3Macau"},{{0x04,0x05,0x06,0x00,0x01,0x0f},"MobitelKH"},
{{0x04,0x05,0x06,0x00,0x02,0x0f},"Helloqb"},{{0x04,0x05,0x06,0x00,0x04,0x0f},"CADCOMMS"},{{0x04,0x05,0x06,0x00,0x05,0x0f},"STARCELL"},{{0x04,0x05,0x06,0x00,0x06,0x0f},"Smart"},
{{0x04,0x05,0x06,0x00,0x08,0x0f},"Metfone"},{{0x04,0x05,0x06,0x00,0x09,0x0f},"BeelineKH"},{{0x04,0x05,0x06,0x01,0x08,0x0f},"Mfone"},{{0x04,0x05,0x07,0x00,0x01,0x0f},"LAOGSM"},
{{0x04,0x05,0x07,0x00,0x02,0x0f},"ETL"},{{0x04,0x05,0x07,0x00,0x03,0x0f},"LAO-ASIA"},{{0x04,0x05,0x07,0x00,0x08,0x0f},"TANGOLAO"},{{0x04,0x06,0x00,0x00,0x00,0x04},"ChinaMobile"},
{{0x04,0x06,0x00,0x00,0x00,0x06},"ChinaMobile"},{{0x04,0x06,0x00,0x00,0x00,0x07},"ChinaMobile"},{{0x04,0x06,0x00,0x00,0x00,0x0f},"China Mobile"},{{0x04,0x06,0x00,0x00,0x00,0x0f},"ChinaMobile"},
{{0x04,0x06,0x00,0x00,0x01,0x0f},"China Unicom"},{{0x04,0x06,0x00,0x00,0x01,0x0f},"ChinaUnicom"},{{0x04,0x06,0x00,0x00,0x07,0x0f},"ChinaMobile"},{{0x04,0x06,0x06,0x00,0x01,0x0f},"FarEasTone"},
{{0x04,0x06,0x06,0x08,0x08,0x0f},"KGTelecom"},{{0x04,0x06,0x06,0x08,0x09,0x0f},"VIBO"},{{0x04,0x06,0x06,0x09,0x02,0x0f},"ChungHwa"},{{0x04,0x06,0x06,0x09,0x03,0x0f},"MobiTai"},
{{0x04,0x06,0x06,0x09,0x07,0x0f},"TaiwanMobile"},{{0x04,0x06,0x06,0x09,0x09,0x0f},"TransAsia"},{{0x04,0x07,0x00,0x00,0x01,0x0f},"Grameenphone"},{{0x04,0x07,0x00,0x00,0x02,0x0f},"Robi"},
{{0x04,0x07,0x00,0x00,0x03,0x0f},"Banglalink"},{{0x04,0x07,0x00,0x00,0x04,0x0f},"Teletalk"},{{0x04,0x07,0x00,0x00,0x07,0x0f},"Airtel"},{{0x04,0x07,0x02,0x00,0x01,0x0f},"Dhiraagu"},
{{0x04,0x07,0x02,0x00,0x02,0x0f},"WMOBILE"},{{0x05,0x00,0x02,0x01,0x02,0x0f},"MYMAXIS"},{{0x05,0x00,0x02,0x01,0x03,0x0f},"MYCELCOM3G"},{{0x05,0x00,0x02,0x01,0x06,0x0f},"DiGi"},
{{0x05,0x00,0x02,0x01,0x08,0x0f},"UMOBILE"},{{0x05,0x00,0x02,0x01,0x09,0x0f},"MYCELCOM"},{{0x05,0x00,0x05,0x00,0x01,0x0f},"Telstra"},{{0x05,0x00,0x05,0x00,0x01,0x0f},"TelstraMobile"},
{{0x05,0x00,0x05,0x00,0x02,0x0f},"Optus"},{{0x05,0x00,0x05,0x00,0x02,0x0f},"Optus"},{{0x05,0x00,0x05,0x00,0x03,0x0f},"Vodafone"},{{0x05,0x00,0x05,0x00,0x03,0x0f},"vodafoneAU"},
{{0x05,0x00,0x05,0x00,0x04,0x0f},"Department of Defence"},{{0x05,0x00,0x05,0x00,0x05,0x0f},"The Ozitel Network"},{{0x05,0x00,0x05,0x00,0x06,0x0f},"Hutchison 3G Australia"},{{0x05,0x00,0x05,0x00,0x06,0x0f},"3"},
{{0x05,0x00,0x05,0x00,0x07,0x0f},"Vodafone"},{{0x05,0x00,0x05,0x00,0x08,0x0f},"One.Tel GSM 1800"},{{0x05,0x00,0x05,0x00,0x09,0x0f},"Airnet Commercial Australia"},{{0x05,0x00,0x05,0x01,0x01,0x0f},"Telstra Corporation"},
{{0x05,0x00,0x05,0x01,0x02,0x0f},"Hutchison Telecommunications "},{{0x05,0x00,0x05,0x01,0x04,0x0f},"AAPT"},{{0x05,0x00,0x05,0x01,0x05,0x0f},"3GIS"},{{0x05,0x00,0x05,0x02,0x04,0x0f},"Advanced Communications"},
{{0x05,0x00,0x05,0x07,0x01,0x0f},"Telstra"},{{0x05,0x00,0x05,0x07,0x02,0x0f},"Telstra Corporation"},{{0x05,0x00,0x05,0x08,0x08,0x0f},"Localstar"},{{0x05,0x00,0x05,0x09,0x00,0x0f},"Optus"},
{{0x05,0x00,0x05,0x09,0x09,0x0f},"One.Tel GSM 1800"},{{0x05,0x01,0x00,0x00,0x01,0x0f},"Indosat"},{{0x05,0x01,0x00,0x00,0x08,0x0f},"Natrindo"},{{0x05,0x01,0x00,0x01,0x00,0x0f},"TELKOMSEL"},
{{0x05,0x01,0x00,0x01,0x01,0x0f},"AXIS+"},{{0x05,0x01,0x00,0x02,0x01,0x0f},"INDIM3"},{{0x05,0x01,0x00,0x08,0x09,0x0f},"HUTCHISONS"},{{0x05,0x01,0x04,0x00,0x02,0x0f},"TLS-TT"},
{{0x05,0x01,0x05,0x00,0x01,0x0f},"ISLACOM"},{{0x05,0x01,0x05,0x00,0x02,0x0f},"GlobeTelecom"},{{0x05,0x01,0x05,0x00,0x03,0x0f},"SMART"},{{0x05,0x01,0x05,0x00,0x05,0x0f},"SUN"},
{{0x05,0x01,0x05,0x01,0x08,0x0f},"Smart"},{{0x05,0x02,0x00,0x00,0x01,0x0f},"AISGSM"},{{0x05,0x02,0x00,0x00,0x04,0x0f},"TRUE"},{{0x05,0x02,0x00,0x00,0x05,0x0f},"DTAC"},
{{0x05,0x02,0x00,0x01,0x00,0x0f},"TRUE"},{{0x05,0x02,0x00,0x01,0x05,0x0f},"TOT"},{{0x05,0x02,0x00,0x01,0x08,0x0f},"DTAC"},{{0x05,0x02,0x00,0x02,0x03,0x0f},"THGSM1800"},
{{0x05,0x02,0x00,0x09,0x09,0x0f},"TRUE"},{{0x05,0x02,0x05,0x00,0x01,0x0f},"SingTel"},{{0x05,0x02,0x05,0x00,0x02,0x0f},"SingTel"},{{0x05,0x02,0x05,0x00,0x03,0x0f},"M1"},
{{0x05,0x02,0x05,0x00,0x05,0x0f},"SSTARHUB"},{{0x05,0x02,0x08,0x00,0x02,0x0f},"B-mobile"},{{0x05,0x02,0x08,0x01,0x01,0x0f},"DSTCom"},{{0x05,0x03,0x00,0x00,0x01,0x0f},"vodafoneNZ"},
{{0x05,0x03,0x00,0x00,0x05,0x0f},"TelecomNZ"},{{0x05,0x03,0x07,0x00,0x01,0x0f},"BMobile"},{{0x05,0x03,0x09,0x00,0x01,0x0f},"U-CALL"},{{0x05,0x04,0x00,0x00,0x01,0x0f},"BREEZE"},
{{0x05,0x04,0x01,0x00,0x01,0x0f},"VUTSMILE"},{{0x05,0x04,0x02,0x00,0x01,0x0f},"VODAFONEFJ"},{{0x05,0x04,0x05,0x00,0x09,0x0f},"TSKL"},{{0x05,0x04,0x06,0x00,0x01,0x0f},"MOBILIS"},
{{0x05,0x04,0x07,0x02,0x00,0x0f},"VINI"},{{0x05,0x04,0x08,0x00,0x01,0x0f},"Telecom"},{{0x05,0x04,0x09,0x02,0x07,0x0f},"SamoaTel"},{{0x05,0x05,0x00,0x00,0x01,0x0f},"FSMTelecom"},
{{0x05,0x05,0x02,0x08,0x00,0x0f},"PalauMobile"},{{0x06,0x00,0x02,0x00,0x01,0x0f},"MobiNiL"},{{0x06,0x00,0x02,0x00,0x02,0x0f},"VodafoneEG"},{{0x06,0x00,0x02,0x00,0x03,0x0f},"Etisalat"},
{{0x06,0x00,0x03,0x00,0x01,0x0f},"Mobilis"},{{0x06,0x00,0x03,0x00,0x02,0x0f},"Djezzy"},{{0x06,0x00,0x04,0x00,0x00,0x0f},"MEDITEL"},{{0x06,0x00,0x04,0x00,0x01,0x0f},"IAM"},
{{0x06,0x00,0x04,0x00,0x02,0x0f},"INWI"},{{0x06,0x00,0x05,0x00,0x01,0x0f},"Orange"},{{0x06,0x00,0x05,0x00,0x02,0x0f},"TUNTEL"},{{0x06,0x00,0x05,0x00,0x03,0x0f},"TUNISIANA"},
{{0x06,0x00,0x06,0x00,0x01,0x0f},"AlMadar"},{{0x06,0x00,0x07,0x00,0x01,0x0f},"Gamcel"},{{0x06,0x00,0x07,0x00,0x02,0x0f},"Africell"},{{0x06,0x00,0x08,0x00,0x01,0x0f},"ALIZE"},
{{0x06,0x00,0x08,0x00,0x02,0x0f},"SENTEL"},{{0x06,0x00,0x09,0x00,0x01,0x0f},"MATTEL"},{{0x06,0x00,0x09,0x01,0x00,0x0f},"Mauritel"},{{0x06,0x01,0x00,0x00,0x01,0x0f},"MALITELML"},
{{0x06,0x01,0x00,0x00,0x02,0x0f},"ORANGEML"},{{0x06,0x01,0x01,0x00,0x02,0x0f},"SotelguiGuinea"},{{0x06,0x01,0x02,0x00,0x02,0x0f},"ACELL-CI"},{{0x06,0x01,0x02,0x00,0x03,0x0f},"Orange"},
{{0x06,0x01,0x02,0x00,0x05,0x0f},"MTNCI"},{{0x06,0x01,0x03,0x00,0x02,0x0f},"Zain"},{{0x06,0x01,0x04,0x00,0x01,0x0f},"Sonitel"},{{0x06,0x01,0x04,0x00,0x02,0x0f},"Zain"},
{{0x06,0x01,0x04,0x00,0x03,0x0f},"Moov"},{{0x06,0x01,0x05,0x00,0x01,0x0f},"TOGOCELL"},{{0x06,0x01,0x05,0x00,0x03,0x0f},"TelecelTogo"},{{0x06,0x01,0x06,0x00,0x02,0x0f},"TLCL-BEN"},
{{0x06,0x01,0x06,0x00,0x03,0x0f},"Areeba"},{{0x06,0x01,0x06,0x00,0x04,0x0f},"BBCOM"},{{0x06,0x01,0x06,0x00,0x05,0x0f},"GloBenin"},{{0x06,0x01,0x07,0x00,0x01,0x0f},"Cellplus"},
{{0x06,0x01,0x07,0x01,0x00,0x0f},"EMTEL"},{{0x06,0x01,0x08,0x00,0x01,0x0f},"Lonestar"},{{0x06,0x01,0x08,0x00,0x04,0x0f},"Comium"},{{0x06,0x01,0x09,0x00,0x01,0x0f},"Zain"},
{{0x06,0x01,0x09,0x00,0x02,0x0f},"MILLICOM"},{{0x06,0x02,0x00,0x00,0x01,0x0f},"Areeba"},{{0x06,0x02,0x00,0x00,0x02,0x0f},"Onetouch"},{{0x06,0x02,0x00,0x00,0x03,0x0f},"Tigo"},
{{0x06,0x02,0x01,0x02,0x00,0x0f},"Airtel"},{{0x06,0x02,0x01,0x03,0x00,0x0f},"MTNNG"},{{0x06,0x02,0x01,0x04,0x00,0x0f},"Mtel"},{{0x06,0x02,0x01,0x05,0x00,0x0f},"GLO"},
{{0x06,0x02,0x01,0x06,0x00,0x0f},"Etisalat"},{{0x06,0x02,0x02,0x00,0x01,0x0f},"Zain"},{{0x06,0x02,0x03,0x00,0x02,0x0f},"Telecel"},{{0x06,0x02,0x03,0x00,0x04,0x0f},"NationLink"},
{{0x06,0x02,0x04,0x00,0x01,0x0f},"MTNCAM"},{{0x06,0x02,0x04,0x00,0x02,0x0f},"OrangeCAM"},{{0x06,0x02,0x05,0x00,0x01,0x0f},"CPVMOVEL"},{{0x06,0x02,0x06,0x00,0x01,0x0f},"CSTmovel"},
{{0x06,0x02,0x07,0x00,0x01,0x0f},"OrangeGQ"},{{0x06,0x02,0x08,0x00,0x01,0x0f},"LIBERTIS"},{{0x06,0x02,0x08,0x00,0x02,0x0f},"TELECEL"},{{0x06,0x02,0x08,0x00,0x03,0x0f},"ZAIN"},
{{0x06,0x02,0x09,0x00,0x01,0x0f},"Zain"},{{0x06,0x02,0x09,0x01,0x00,0x0f},"Libertis"},{{0x06,0x03,0x00,0x00,0x01,0x0f},"VodacomCD"},{{0x06,0x03,0x00,0x00,0x05,0x0f},"SCELLCD"},
{{0x06,0x03,0x01,0x00,0x02,0x0f},"Unitel"},{{0x06,0x03,0x03,0x00,0x01,0x0f},"C&WSEY"},{{0x06,0x03,0x03,0x01,0x00,0x0f},"AIRTEL"},{{0x06,0x03,0x04,0x00,0x01,0x0f},"Zain"},
{{0x06,0x03,0x04,0x00,0x02,0x0f},"MTN"},{{0x06,0x03,0x04,0x00,0x07,0x0f},"SudaniOne"},{{0x06,0x03,0x05,0x01,0x00,0x0f},"MTN"},{{0x06,0x03,0x05,0x01,0x03,0x0f},"Tigo"},
{{0x06,0x03,0x06,0x00,0x01,0x0f},"ETHMTN"},{{0x06,0x03,0x07,0x00,0x01,0x0f},"Telesom"},{{0x06,0x03,0x07,0x00,0x04,0x0f},"SOMAFONE"},{{0x06,0x03,0x07,0x01,0x00,0x0f},"Nationlink"},
{{0x06,0x03,0x07,0x03,0x00,0x0f},"Golis"},{{0x06,0x03,0x07,0x08,0x02,0x0f},"Telsom"},{{0x06,0x03,0x08,0x00,0x01,0x0f},"EVATIS"},{{0x06,0x03,0x09,0x00,0x02,0x0f},"Safaricom"},
{{0x06,0x03,0x09,0x00,0x03,0x0f},"AirtelKe"},{{0x06,0x03,0x09,0x00,0x05,0x0f},"yu"},{{0x06,0x03,0x09,0x00,0x07,0x0f},"OrangeKenya"},{{0x06,0x04,0x00,0x00,0x02,0x0f},"Tigo"},
{{0x06,0x04,0x00,0x00,0x03,0x0f},"ZANTEL"},{{0x06,0x04,0x00,0x00,0x04,0x0f},"VodaCom"},{{0x06,0x04,0x00,0x00,0x05,0x0f},"Airtel"},{{0x06,0x04,0x00,0x00,0x08,0x0f},"Smart"}, 
{{0x06,0x04,0x00,0x00,0x09,0x0f},"Hits"},{{0x06,0x04,0x01,0x00,0x01,0x0f},"Zain"}, {{0x06,0x04,0x01,0x01,0x00,0x0f},"MTN"},{{0x06,0x04,0x01,0x01,0x01,0x0f},"UTMobile"},
{{0x06,0x04,0x01,0x02,0x02,0x0f},"WaridTel"},{{0x06,0x04,0x02,0x00,0x01,0x0f},"Spacetel"}, {{0x06,0x04,0x02,0x00,0x02,0x0f},"Safaris"},{{0x06,0x04,0x02,0x00,0x03,0x0f},"ONATEL"},
{{0x06,0x04,0x03,0x00,0x01,0x0f},"mCel"},{{0x06,0x04,0x03,0x00,0x04,0x0f},"VodaCom"}, {{0x06,0x04,0x05,0x00,0x01,0x0f},"Zain"},{{0x06,0x04,0x05,0x00,0x02,0x0f},"MTN"},
{{0x06,0x04,0x06,0x00,0x01,0x0f},"Airtel MG"},{{0x06,0x04,0x06,0x00,0x02,0x0f},"Orange"},{{0x06,0x04,0x06,0x00,0x04,0x0f},"TELMA"},{{0x06,0x04,0x07,0x00,0x00,0x0f},"Orange"},
{{0x06,0x04,0x07,0x00,0x02,0x0f},"OUTREMER"},{{0x06,0x04,0x07,0x01,0x00,0x0f},"SFR"},{{0x06,0x04,0x08,0x00,0x01,0x0f},"NetOne"},{{0x06,0x04,0x08,0x00,0x03,0x0f},"TELECEL"},
{{0x06,0x04,0x08,0x00,0x04,0x0f},"ECONET"},{{0x06,0x04,0x09,0x00,0x01,0x0f},"MTC"},{{0x06,0x05,0x00,0x00,0x01,0x0f},"TNM"},{{0x06,0x05,0x00,0x01,0x00,0x0f},"AIRTEL"},
{{0x06,0x05,0x01,0x00,0x01,0x0f},"Vodacom-LS"},{{0x06,0x05,0x01,0x00,0x02,0x0f},"Econet"},{{0x06,0x05,0x02,0x00,0x01,0x0f},"MASCOM"},{{0x06,0x05,0x02,0x00,0x02,0x0f},"Orange"},
{{0x06,0x05,0x03,0x01,0x00,0x0f},"MTN"},{{0x06,0x05,0x04,0x00,0x00,0x01},"HURI"},{{0x06,0x05,0x05,0x00,0x01,0x0f},"VodaCom"},{{0x06,0x05,0x05,0x00,0x02,0x0f},"8.ta"},
{{0x06,0x05,0x05,0x00,0x07,0x0f},"CellC"},{{0x06,0x05,0x05,0x01,0x00,0x0f},"MTN"},{{0x07,0x00,0x02,0x06,0x07,0x0f},"BTL"},{{0x07,0x00,0x04,0x00,0x01,0x0f},"ClaroGTM"},
{{0x07,0x00,0x04,0x00,0x02,0x0f},"Tigo"},{{0x07,0x00,0x04,0x00,0x03,0x0f},"movistar"},{{0x07,0x00,0x06,0x00,0x01,0x0f},"CLAROSLV"},{{0x07,0x00,0x06,0x00,0x02,0x0f},"Digicel"},
{{0x07,0x00,0x06,0x00,0x03,0x0f},"TELEMOVIL"},{{0x07,0x00,0x08,0x00,0x00,0x01},"CLAROHND"},{{0x07,0x00,0x08,0x00,0x02,0x0f},"CELTELHND"},{{0x07,0x01,0x00,0x02,0x01,0x0f},"ClaroNIC"},
{{0x07,0x01,0x00,0x07,0x03,0x0f},"ClaroNIC"},{{0x07,0x01,0x02,0x00,0x01,0x0f},"I.C.E."},{{0x07,0x01,0x02,0x00,0x02,0x0f},"I.C.E."},{{0x07,0x01,0x04,0x00,0x01,0x0f},"Cable & Wireless"},
{{0x07,0x01,0x06,0x00,0x06,0x0f},"movistar"},{{0x07,0x01,0x06,0x01,0x00,0x0f},"CLAROPER"},{{0x07,0x02,0x02,0x00,0x07,0x0f},"Movistar"},{{0x07,0x02,0x02,0x03,0x01,0x00},"CLARO"},
{{0x07,0x02,0x02,0x03,0x04,0x0f},"Personal"},{{0x07,0x02,0x04,0x00,0x02,0x0f},"TIMBRASIL"},{{0x07,0x02,0x04,0x00,0x03,0x0f},"TIMBRASIL"},{{0x07,0x02,0x04,0x00,0x04,0x0f},"TIMBRASIL"},
{{0x07,0x02,0x04,0x00,0x05,0x0f},"Claro"},{{0x07,0x02,0x04,0x00,0x06,0x0f},"VIVO"},{{0x07,0x02,0x04,0x01,0x00,0x0f},"VIVO"},{{0x07,0x02,0x04,0x01,0x01,0x0f},"VIVO"},
{{0x07,0x02,0x04,0x01,0x05,0x0f},"Sercomtel"},{{0x07,0x02,0x04,0x01,0x06,0x0f},"BrasilTelecom"},{{0x07,0x02,0x04,0x02,0x03,0x0f},"VIVO"},{{0x07,0x02,0x04,0x02,0x04,0x0f},"AMAZONIA"},
{{0x07,0x02,0x04,0x03,0x01,0x0f},"Oi"},{{0x07,0x02,0x04,0x03,0x02,0x0f},"CTBC"},{{0x07,0x02,0x04,0x03,0x03,0x0f},"CTBC"},{{0x07,0x02,0x04,0x03,0x04,0x0f},"CTBC"},
{{0x07,0x03,0x00,0x00,0x01,0x0f},"ENTEL"},{{0x07,0x03,0x00,0x00,0x02,0x0f},"movistar"},{{0x07,0x03,0x00,0x00,0x03,0x0f},"CLAROCHL"},{{0x07,0x03,0x02,0x01,0x00,0x01},"movistar"},
{{0x07,0x03,0x02,0x01,0x00,0x03},"TIGO"},{{0x07,0x03,0x02,0x01,0x02,0x03},"Comcel"},{{0x07,0x03,0x04,0x00,0x02,0x0f},"Digitel"},{{0x07,0x03,0x04,0x00,0x04,0x0f},"movistar"},
{{0x07,0x03,0x04,0x00,0x06,0x0f},"movilnet"},{{0x07,0x03,0x06,0x00,0x01,0x0f},"VIVA"},{{0x07,0x03,0x06,0x00,0x02,0x0f},"EMOVIL"},{{0x07,0x03,0x06,0x00,0x03,0x0f},"Telecel"},
{{0x07,0x03,0x08,0x00,0x01,0x0f},"DIGICEL"},{{0x07,0x04,0x00,0x00,0x00,0x0f},"movistar"},{{0x07,0x04,0x00,0x00,0x01,0x0f},"PORTAGSM"},{{0x07,0x04,0x04,0x00,0x01,0x0f},"VOX"},
{{0x07,0x04,0x04,0x00,0x02,0x0f},"Claro"},{{0x07,0x04,0x04,0x00,0x04,0x0f},"TigoPY"},{{0x07,0x04,0x04,0x00,0x05,0x0f},"Personal"},{{0x07,0x04,0x06,0x00,0x02,0x0f},"Telesur"},
{{0x07,0x04,0x08,0x00,0x01,0x0f},"Ancel"},{{0x07,0x04,0x08,0x00,0x07,0x0f},"Movistar"},{{0x07,0x04,0x08,0x01,0x00,0x0f},"CLAROUY"},{{0x00,0x00,0x00,0x00,0x00,0x00},"UNKNOWN"} };

static void modcellular_get_operator_name(uint8_t in_plmn[PLMN_STR_MAX_LENGTH], char *pOperatorName) {    
    const uint8_t *pOperID;
    const char *pName;
    uint8_t plmn[PLMN_STR_MAX_LENGTH];
    for(int i = 0 ; i < PLMN_STR_MAX_LENGTH; i++) {
        plmn[i] = cmsDigitCharToNum(in_plmn[i]);
        if(plmn[i] == 0xFF) plmn[i] = 0x0F;
    }
    uint32_t index = 0;
    int maxlen = 0;
    do {
        pOperID = _OperatorInfo[index].OperatorId;
        pName = _OperatorInfo[index].OperatorName;        
        if((int)strlen(pName) > maxlen) {
            maxlen = strlen(pName);
            LUAT_DEBUG_PRINT("name=%s, maxlen=%d", pName, maxlen);
        }
        
        int8_t res = 1;
        for (uint8_t i = 0; i < 6; i++) {
            if (pOperID[i] != plmn[i]) {
                res = 0;
                break;
            }
        }

        if (res) {
            strcpy(pOperatorName, pName);
            return;
        }
        index++;
    } while (pOperID[0] != 0x00);
    strcpy(pOperatorName, pName);
    
}
